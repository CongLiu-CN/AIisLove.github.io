<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Improving a model | Cong Liu 刘聪</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Improving a model" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="There are three ways to improve a model." />
<meta property="og:description" content="There are three ways to improve a model." />
<link rel="canonical" href="https://www.liucong.ca/2020/04/16/Improve-a-model.html" />
<meta property="og:url" content="https://www.liucong.ca/2020/04/16/Improve-a-model.html" />
<meta property="og:site_name" content="Cong Liu 刘聪" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-16T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"There are three ways to improve a model.","@type":"BlogPosting","headline":"Improving a model","dateModified":"2020-04-16T00:00:00-05:00","datePublished":"2020-04-16T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.liucong.ca/2020/04/16/Improve-a-model.html"},"url":"https://www.liucong.ca/2020/04/16/Improve-a-model.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://www.liucong.ca/feed.xml" title="Cong Liu | 刘聪" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Improving a model | Cong Liu 刘聪</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Improving a model" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="There are three ways to improve a model." />
<meta property="og:description" content="There are three ways to improve a model." />
<link rel="canonical" href="https://www.liucong.ca/2020/04/16/Improve-a-model.html" />
<meta property="og:url" content="https://www.liucong.ca/2020/04/16/Improve-a-model.html" />
<meta property="og:site_name" content="Cong Liu 刘聪" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-16T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"There are three ways to improve a model.","@type":"BlogPosting","headline":"Improving a model","dateModified":"2020-04-16T00:00:00-05:00","datePublished":"2020-04-16T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.liucong.ca/2020/04/16/Improve-a-model.html"},"url":"https://www.liucong.ca/2020/04/16/Improve-a-model.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://www.liucong.ca/feed.xml" title="Cong Liu | 刘聪" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Cong Liu | 刘聪</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Improving a model</h1><p class="page-description">There are three ways to improve a model.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-04-16T00:00:00-05:00" itemprop="datePublished">
        Apr 16, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      22 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/CongLiu-CN/AIisLove/tree/master/_notebooks/2020-04-16-Improve-a-model.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/CongLiu-CN/AIisLove/master?filepath=_notebooks%2F2020-04-16-Improve-a-model.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/CongLiu-CN/AIisLove/blob/master/_notebooks/2020-04-16-Improve-a-model.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-04-16-Improve-a-model.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Standard imports</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First predictions = baseline predictions. First model = baseline model.</p>
<p>From a data perspective:</p>
<ul>
<li>Could we collect more data? (generally, the more data, the better)</li>
<li>Could we improve our data?</li>
</ul>
<p>From a model perspective:</p>
<ul>
<li>Is there a better model we could use?</li>
<li>Could we improve the current model?</li>
</ul>
<p>Hyperparameters vs. Parameters</p>
<ul>
<li>Parameters = model find these patterns in data</li>
<li>Hyperparameters = settings on a model you can adjust to (potentially) improve its ability to find patterns</li>
</ul>
<p>Three ways to adjust hyperparameters:</p>
<ol>
<li>By hand</li>
<li>Randomly with RandomSearchCV</li>
<li>Exhaustively with GridSearchCV</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">get_params</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;bootstrap&#39;: True,
 &#39;ccp_alpha&#39;: 0.0,
 &#39;class_weight&#39;: None,
 &#39;criterion&#39;: &#39;gini&#39;,
 &#39;max_depth&#39;: None,
 &#39;max_features&#39;: &#39;auto&#39;,
 &#39;max_leaf_nodes&#39;: None,
 &#39;max_samples&#39;: None,
 &#39;min_impurity_decrease&#39;: 0.0,
 &#39;min_impurity_split&#39;: None,
 &#39;min_samples_leaf&#39;: 1,
 &#39;min_samples_split&#39;: 2,
 &#39;min_weight_fraction_leaf&#39;: 0.0,
 &#39;n_estimators&#39;: 100,
 &#39;n_jobs&#39;: None,
 &#39;oob_score&#39;: False,
 &#39;random_state&#39;: None,
 &#39;verbose&#39;: 0,
 &#39;warm_start&#39;: False}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're going to try and adjust:</p>
<ul>
<li><code>max_depth</code></li>
<li><code>max_features</code></li>
<li><code>min_samples_leaf</code></li>
<li><code>min_samples_split</code></li>
<li><code>n_estimators</code></li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>

<span class="k">def</span> <span class="nf">evaluate_preds</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs evaluation comparison on y_true lables vs. y_preds labels</span>
<span class="sd">    on a classification model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">precision_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>
    <span class="n">recall</span> <span class="o">=</span> <span class="n">recall_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">f1_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>
    <span class="n">metric_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">accuracy</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                   <span class="s2">&quot;precision&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">precision</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                   <span class="s2">&quot;recall&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">recall</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                   <span class="s2">&quot;f1&quot;</span><span class="p">:</span> <span class="nb">round</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)}</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Acc: </span><span class="si">{</span><span class="n">accuracy</span> <span class="o">*</span> <span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Precision: </span><span class="si">{</span><span class="n">precision</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recall: </span><span class="si">{</span><span class="n">recall</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F1 score: </span><span class="si">{</span><span class="n">f1</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">metric_dict</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">heart_disease</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/CongLiu-CN/zero-to-mastery-ml/master/data/heart-disease.csv&quot;</span><span class="p">)</span>
<span class="n">heart_disease</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63</td>
      <td>1</td>
      <td>3</td>
      <td>145</td>
      <td>233</td>
      <td>1</td>
      <td>0</td>
      <td>150</td>
      <td>0</td>
      <td>2.3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>37</td>
      <td>1</td>
      <td>2</td>
      <td>130</td>
      <td>250</td>
      <td>0</td>
      <td>1</td>
      <td>187</td>
      <td>0</td>
      <td>3.5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>41</td>
      <td>0</td>
      <td>1</td>
      <td>130</td>
      <td>204</td>
      <td>0</td>
      <td>0</td>
      <td>172</td>
      <td>0</td>
      <td>1.4</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>56</td>
      <td>1</td>
      <td>1</td>
      <td>120</td>
      <td>236</td>
      <td>0</td>
      <td>1</td>
      <td>178</td>
      <td>0</td>
      <td>0.8</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>57</td>
      <td>0</td>
      <td>0</td>
      <td>120</td>
      <td>354</td>
      <td>0</td>
      <td>1</td>
      <td>163</td>
      <td>1</td>
      <td>0.6</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># shuffle the data</span>
<span class="n">heart_disease_shuffled</span> <span class="o">=</span> <span class="n">heart_disease</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Split into X &amp; y</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">heart_disease_shuffled</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">heart_disease_shuffled</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>

<span class="c1"># Split the data into train, validation &amp; test sets</span>
<span class="n">train_split</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">0.7</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">heart_disease_shuffled</span><span class="p">))</span>  <span class="c1"># 70% of data</span>
<span class="n">valid_split</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">train_split</span> <span class="o">+</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">heart_disease_shuffled</span><span class="p">))</span> <span class="c1"># 15% of data</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="n">train_split</span><span class="p">],</span> <span class="n">y</span><span class="p">[:</span><span class="n">train_split</span><span class="p">]</span>
<span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">train_split</span><span class="p">:</span><span class="n">valid_split</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">train_split</span><span class="p">:</span><span class="n">valid_split</span><span class="p">]</span>
<span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">valid_split</span><span class="p">:],</span> <span class="n">y</span><span class="p">[</span><span class="n">valid_split</span><span class="p">:]</span>

<span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_valid</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(212, 45, 46)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Make baseline predicitons</span>
<span class="n">y_preds</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>

<span class="c1"># Evaluate the classifier on validation set</span>
<span class="n">baseline_metrics</span> <span class="o">=</span> <span class="n">evaluate_preds</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>
<span class="n">baseline_metrics</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Acc: 93.33%
Precision: 0.93
Recall: 0.96
F1 score: 0.95
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;accuracy&#39;: 0.93, &#39;precision&#39;: 0.93, &#39;recall&#39;: 0.96, &#39;f1&#39;: 0.95}</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Create a second classifier with different hyperparameters</span>
<span class="n">clf_2</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="n">clf_2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Make predictions</span>
<span class="n">y_preds_2</span> <span class="o">=</span> <span class="n">clf_2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>

<span class="c1"># Evaluate the 2nd classifier</span>
<span class="n">clf_2_metrics</span> <span class="o">=</span> <span class="n">evaluate_preds</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">y_preds_2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Acc: 93.33%
Precision: 0.93
Recall: 0.96
F1 score: 0.95
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="2.-Hyperparameter-tuning-with-RandomizedSearchCV">2. Hyperparameter tuning with RandomizedSearchCV<a class="anchor-link" href="#2.-Hyperparameter-tuning-with-RandomizedSearchCV"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RandomizedSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;n_estimators&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1200</span><span class="p">],</span>
       <span class="s2">&quot;max_depth&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
       <span class="s2">&quot;max_features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span> <span class="s2">&quot;sqrt&quot;</span><span class="p">],</span>
       <span class="s2">&quot;min_samples_split&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
       <span class="s2">&quot;min_samples_leaf&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]}</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Split into X &amp; y</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">heart_disease_shuffled</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">heart_disease_shuffled</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>

<span class="c1"># Split into train and test sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Instantiate RandomForestClassifier</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Setup RandomizedSearchCV</span>
<span class="n">rs_clf</span> <span class="o">=</span> <span class="n">RandomizedSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span>
                            <span class="n">param_distributions</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span>
                            <span class="n">n_iter</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="c1"># number of models to try</span>
                            <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                            <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Fit the RandomizedSearchCV version of clf</span>
<span class="n">rs_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Fitting 5 folds for each of 10 candidates, totalling 50 fits
[CV] n_estimators=1000, min_samples_split=4, min_samples_leaf=2, max_features=auto, max_depth=20 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[CV]  n_estimators=1000, min_samples_split=4, min_samples_leaf=2, max_features=auto, max_depth=20, total=   3.1s
[CV] n_estimators=1000, min_samples_split=4, min_samples_leaf=2, max_features=auto, max_depth=20 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    3.0s remaining:    0.0s
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[CV]  n_estimators=1000, min_samples_split=4, min_samples_leaf=2, max_features=auto, max_depth=20, total=   3.1s
[CV] n_estimators=1000, min_samples_split=4, min_samples_leaf=2, max_features=auto, max_depth=20 
[CV]  n_estimators=1000, min_samples_split=4, min_samples_leaf=2, max_features=auto, max_depth=20, total=   3.4s
[CV] n_estimators=1000, min_samples_split=4, min_samples_leaf=2, max_features=auto, max_depth=20 
[CV]  n_estimators=1000, min_samples_split=4, min_samples_leaf=2, max_features=auto, max_depth=20, total=   3.2s
[CV] n_estimators=1000, min_samples_split=4, min_samples_leaf=2, max_features=auto, max_depth=20 
[CV]  n_estimators=1000, min_samples_split=4, min_samples_leaf=2, max_features=auto, max_depth=20, total=   3.1s
[CV] n_estimators=10, min_samples_split=6, min_samples_leaf=1, max_features=sqrt, max_depth=None 
[CV]  n_estimators=10, min_samples_split=6, min_samples_leaf=1, max_features=sqrt, max_depth=None, total=   0.0s
[CV] n_estimators=10, min_samples_split=6, min_samples_leaf=1, max_features=sqrt, max_depth=None 
[CV]  n_estimators=10, min_samples_split=6, min_samples_leaf=1, max_features=sqrt, max_depth=None, total=   0.0s
[CV] n_estimators=10, min_samples_split=6, min_samples_leaf=1, max_features=sqrt, max_depth=None 
[CV]  n_estimators=10, min_samples_split=6, min_samples_leaf=1, max_features=sqrt, max_depth=None, total=   0.0s
[CV] n_estimators=10, min_samples_split=6, min_samples_leaf=1, max_features=sqrt, max_depth=None 
[CV]  n_estimators=10, min_samples_split=6, min_samples_leaf=1, max_features=sqrt, max_depth=None, total=   0.0s
[CV] n_estimators=10, min_samples_split=6, min_samples_leaf=1, max_features=sqrt, max_depth=None 
[CV]  n_estimators=10, min_samples_split=6, min_samples_leaf=1, max_features=sqrt, max_depth=None, total=   0.0s
[CV] n_estimators=10, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=None 
[CV]  n_estimators=10, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=None, total=   0.0s
[CV] n_estimators=10, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=None 
[CV]  n_estimators=10, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=None, total=   0.0s
[CV] n_estimators=10, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=None 
[CV]  n_estimators=10, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=None, total=   0.0s
[CV] n_estimators=10, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=None 
[CV]  n_estimators=10, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=None, total=   0.0s
[CV] n_estimators=10, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=None 
[CV]  n_estimators=10, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=None, total=   0.0s
[CV] n_estimators=1000, min_samples_split=2, min_samples_leaf=2, max_features=sqrt, max_depth=20 
[CV]  n_estimators=1000, min_samples_split=2, min_samples_leaf=2, max_features=sqrt, max_depth=20, total=   3.0s
[CV] n_estimators=1000, min_samples_split=2, min_samples_leaf=2, max_features=sqrt, max_depth=20 
[CV]  n_estimators=1000, min_samples_split=2, min_samples_leaf=2, max_features=sqrt, max_depth=20, total=   3.0s
[CV] n_estimators=1000, min_samples_split=2, min_samples_leaf=2, max_features=sqrt, max_depth=20 
[CV]  n_estimators=1000, min_samples_split=2, min_samples_leaf=2, max_features=sqrt, max_depth=20, total=   3.1s
[CV] n_estimators=1000, min_samples_split=2, min_samples_leaf=2, max_features=sqrt, max_depth=20 
[CV]  n_estimators=1000, min_samples_split=2, min_samples_leaf=2, max_features=sqrt, max_depth=20, total=   3.7s
[CV] n_estimators=1000, min_samples_split=2, min_samples_leaf=2, max_features=sqrt, max_depth=20 
[CV]  n_estimators=1000, min_samples_split=2, min_samples_leaf=2, max_features=sqrt, max_depth=20, total=   3.2s
[CV] n_estimators=500, min_samples_split=2, min_samples_leaf=4, max_features=auto, max_depth=10 
[CV]  n_estimators=500, min_samples_split=2, min_samples_leaf=4, max_features=auto, max_depth=10, total=   1.5s
[CV] n_estimators=500, min_samples_split=2, min_samples_leaf=4, max_features=auto, max_depth=10 
[CV]  n_estimators=500, min_samples_split=2, min_samples_leaf=4, max_features=auto, max_depth=10, total=   1.5s
[CV] n_estimators=500, min_samples_split=2, min_samples_leaf=4, max_features=auto, max_depth=10 
[CV]  n_estimators=500, min_samples_split=2, min_samples_leaf=4, max_features=auto, max_depth=10, total=   1.5s
[CV] n_estimators=500, min_samples_split=2, min_samples_leaf=4, max_features=auto, max_depth=10 
[CV]  n_estimators=500, min_samples_split=2, min_samples_leaf=4, max_features=auto, max_depth=10, total=   1.5s
[CV] n_estimators=500, min_samples_split=2, min_samples_leaf=4, max_features=auto, max_depth=10 
[CV]  n_estimators=500, min_samples_split=2, min_samples_leaf=4, max_features=auto, max_depth=10, total=   1.5s
[CV] n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=sqrt, max_depth=None 
[CV]  n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=sqrt, max_depth=None, total=   1.5s
[CV] n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=sqrt, max_depth=None 
[CV]  n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=sqrt, max_depth=None, total=   1.5s
[CV] n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=sqrt, max_depth=None 
[CV]  n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=sqrt, max_depth=None, total=   1.5s
[CV] n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=sqrt, max_depth=None 
[CV]  n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=sqrt, max_depth=None, total=   1.5s
[CV] n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=sqrt, max_depth=None 
[CV]  n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=sqrt, max_depth=None, total=   1.6s
[CV] n_estimators=1000, min_samples_split=6, min_samples_leaf=4, max_features=sqrt, max_depth=None 
[CV]  n_estimators=1000, min_samples_split=6, min_samples_leaf=4, max_features=sqrt, max_depth=None, total=   3.0s
[CV] n_estimators=1000, min_samples_split=6, min_samples_leaf=4, max_features=sqrt, max_depth=None 
[CV]  n_estimators=1000, min_samples_split=6, min_samples_leaf=4, max_features=sqrt, max_depth=None, total=   3.0s
[CV] n_estimators=1000, min_samples_split=6, min_samples_leaf=4, max_features=sqrt, max_depth=None 
[CV]  n_estimators=1000, min_samples_split=6, min_samples_leaf=4, max_features=sqrt, max_depth=None, total=   3.1s
[CV] n_estimators=1000, min_samples_split=6, min_samples_leaf=4, max_features=sqrt, max_depth=None 
[CV]  n_estimators=1000, min_samples_split=6, min_samples_leaf=4, max_features=sqrt, max_depth=None, total=   3.0s
[CV] n_estimators=1000, min_samples_split=6, min_samples_leaf=4, max_features=sqrt, max_depth=None 
[CV]  n_estimators=1000, min_samples_split=6, min_samples_leaf=4, max_features=sqrt, max_depth=None, total=   3.0s
[CV] n_estimators=10, min_samples_split=2, min_samples_leaf=2, max_features=auto, max_depth=10 
[CV]  n_estimators=10, min_samples_split=2, min_samples_leaf=2, max_features=auto, max_depth=10, total=   0.0s
[CV] n_estimators=10, min_samples_split=2, min_samples_leaf=2, max_features=auto, max_depth=10 
[CV]  n_estimators=10, min_samples_split=2, min_samples_leaf=2, max_features=auto, max_depth=10, total=   0.0s
[CV] n_estimators=10, min_samples_split=2, min_samples_leaf=2, max_features=auto, max_depth=10 
[CV]  n_estimators=10, min_samples_split=2, min_samples_leaf=2, max_features=auto, max_depth=10, total=   0.0s
[CV] n_estimators=10, min_samples_split=2, min_samples_leaf=2, max_features=auto, max_depth=10 
[CV]  n_estimators=10, min_samples_split=2, min_samples_leaf=2, max_features=auto, max_depth=10, total=   0.0s
[CV] n_estimators=10, min_samples_split=2, min_samples_leaf=2, max_features=auto, max_depth=10 
[CV]  n_estimators=10, min_samples_split=2, min_samples_leaf=2, max_features=auto, max_depth=10, total=   0.0s
[CV] n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=20 
[CV]  n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=20, total=   1.5s
[CV] n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=20 
[CV]  n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=20, total=   1.5s
[CV] n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=20 
[CV]  n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=20, total=   1.5s
[CV] n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=20 
[CV]  n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=20, total=   1.8s
[CV] n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=20 
[CV]  n_estimators=500, min_samples_split=4, min_samples_leaf=4, max_features=auto, max_depth=20, total=   2.3s
[CV] n_estimators=200, min_samples_split=4, min_samples_leaf=2, max_features=sqrt, max_depth=None 
[CV]  n_estimators=200, min_samples_split=4, min_samples_leaf=2, max_features=sqrt, max_depth=None, total=   0.7s
[CV] n_estimators=200, min_samples_split=4, min_samples_leaf=2, max_features=sqrt, max_depth=None 
[CV]  n_estimators=200, min_samples_split=4, min_samples_leaf=2, max_features=sqrt, max_depth=None, total=   0.7s
[CV] n_estimators=200, min_samples_split=4, min_samples_leaf=2, max_features=sqrt, max_depth=None 
[CV]  n_estimators=200, min_samples_split=4, min_samples_leaf=2, max_features=sqrt, max_depth=None, total=   0.6s
[CV] n_estimators=200, min_samples_split=4, min_samples_leaf=2, max_features=sqrt, max_depth=None 
[CV]  n_estimators=200, min_samples_split=4, min_samples_leaf=2, max_features=sqrt, max_depth=None, total=   0.6s
[CV] n_estimators=200, min_samples_split=4, min_samples_leaf=2, max_features=sqrt, max_depth=None 
[CV]  n_estimators=200, min_samples_split=4, min_samples_leaf=2, max_features=sqrt, max_depth=None, total=   0.6s
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=1)]: Done  50 out of  50 | elapsed:  1.2min finished
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rs_clf</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;n_estimators&#39;: 1000,
 &#39;min_samples_split&#39;: 6,
 &#39;min_samples_leaf&#39;: 4,
 &#39;max_features&#39;: &#39;sqrt&#39;,
 &#39;max_depth&#39;: None}</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Make predictions with the best hyperparamters</span>
<span class="n">rs_y_preds</span> <span class="o">=</span> <span class="n">rs_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Evaluate the predictions</span>
<span class="n">rs_metrics</span> <span class="o">=</span> <span class="n">evaluate_preds</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">rs_y_preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Acc: 85.25%
Precision: 0.79
Recall: 0.93
F1 score: 0.86
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3.-Hyperparameter-tuning-with-GridSearchCV">3. Hyperparameter tuning with GridSearchCV<a class="anchor-link" href="#3.-Hyperparameter-tuning-with-GridSearchCV"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;n_estimators&#39;: [10, 100, 200, 500, 1000, 1200],
 &#39;max_depth&#39;: [None, 5, 10, 20, 30],
 &#39;max_features&#39;: [&#39;auto&#39;, &#39;sqrt&#39;],
 &#39;min_samples_split&#39;: [2, 4, 6],
 &#39;min_samples_leaf&#39;: [1, 2, 4]}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>GridSearchCV will try all the combinations.</p>
<p>Use <code>best_params_</code> to refine the grid.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grid_2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">],</span>
        <span class="s1">&#39;max_features&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;sqrt&#39;</span><span class="p">],</span>
        <span class="s1">&#39;min_samples_split&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span>
        <span class="s1">&#39;min_samples_leaf&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span> 

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Split into X &amp; y</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">heart_disease_shuffled</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">heart_disease_shuffled</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>

<span class="c1"># Split into train and test sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Instantiate RandomForestClassifier</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Setup GridSearchCV</span>
<span class="n">gs_clf</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">clf</span><span class="p">,</span>
                      <span class="n">param_grid</span><span class="o">=</span><span class="n">grid_2</span><span class="p">,</span>
                      <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                      <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Fit the GridSearchCV version of clf</span>
<span class="n">gs_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Fitting 5 folds for each of 12 candidates, totalling 60 fits
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=100 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=100 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.1s remaining:    0.0s
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=200, total=   0.5s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=200, total=   0.5s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=200, total=   0.5s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=1, min_samples_split=6, n_estimators=500, total=   1.1s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=200, total=   0.5s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=200, total=   0.5s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=500, total=   1.1s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=500, total=   1.2s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=500, total=   1.1s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=500, total=   1.1s
[CV] max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=auto, min_samples_leaf=2, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=1, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=100 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=100, total=   0.2s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=200 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=200, total=   0.4s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=500, total=   1.0s
[CV] max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=500 
[CV]  max_depth=None, max_features=sqrt, min_samples_leaf=2, min_samples_split=6, n_estimators=500, total=   1.0s
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=1)]: Done  60 out of  60 | elapsed:   34.0s finished
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gs_clf</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;max_depth&#39;: None,
 &#39;max_features&#39;: &#39;sqrt&#39;,
 &#39;min_samples_leaf&#39;: 2,
 &#39;min_samples_split&#39;: 6,
 &#39;n_estimators&#39;: 200}</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gs_y_preds</span> <span class="o">=</span> <span class="n">gs_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># evaluate the predictions</span>
<span class="n">gs_metrics</span> <span class="o">=</span> <span class="n">evaluate_preds</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">gs_y_preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Acc: 85.25%
Precision: 0.79
Recall: 0.93
F1 score: 0.86
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lets compare our different models' metrics.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">compare_metrics</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;baseline&quot;</span><span class="p">:</span> <span class="n">baseline_metrics</span><span class="p">,</span>
                               <span class="s2">&quot;clf_2&quot;</span><span class="p">:</span> <span class="n">clf_2_metrics</span><span class="p">,</span>
                                <span class="s2">&quot;random search&quot;</span><span class="p">:</span> <span class="n">rs_metrics</span><span class="p">,</span>
                                <span class="s2">&quot;grid search&quot;</span><span class="p">:</span> <span class="n">gs_metrics</span><span class="p">})</span>

<span class="n">compare_metrics</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>baseline</th>
      <th>clf_2</th>
      <th>random search</th>
      <th>grid search</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>accuracy</th>
      <td>0.93</td>
      <td>0.93</td>
      <td>0.85</td>
      <td>0.85</td>
    </tr>
    <tr>
      <th>precision</th>
      <td>0.93</td>
      <td>0.93</td>
      <td>0.79</td>
      <td>0.79</td>
    </tr>
    <tr>
      <th>recall</th>
      <td>0.96</td>
      <td>0.96</td>
      <td>0.93</td>
      <td>0.93</td>
    </tr>
    <tr>
      <th>f1</th>
      <td>0.95</td>
      <td>0.95</td>
      <td>0.86</td>
      <td>0.86</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">compare_metrics</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlMAAAH2CAYAAABUeAkoAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjMsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+AADFEAAAgAElEQVR4nO3deZhWdd348fcHRFBRXMAeE3TQh4pVwMGVxKLcMjD1l5IL5oJLpC32+9nV8wS5p2Zmj2G2uOSSpKUkmjy5ESTF4CDJ4iMXokyaGiLGpoLf3x8zzDPAwAx8bzg3w/t1XVzOue8zZz4Dt8Obc859TqSUkCRJ0qZpVfQAkiRJWzNjSpIkKYMxJUmSlMGYkiRJymBMSZIkZTCmJEmSMjQZUxHxy4h4MyJeWM/zERE3R8TciJgREf1LP6YkSVJ52q4Z69wB/Bdw13qePxboVvfrYGBM3X83qGPHjqmioqJZQ0qSJBVp2rRp/0wpdWrsuSZjKqU0MSIqNrDKUOCuVHv1zykRsWtE7JVSen1D262oqKCqqqqpLy9JklS4iHhlfc+V4pypvYEFDZZr6h6TJElq8UoRU9HIY43eoyYiRkREVURUvfXWWyX40pIkScUqRUzVAF0aLHcGXmtsxZTSbSmlypRSZadOjR52lCRJ2qo05wT0powDRkbEr6k98XxxU+dLSSrOBx98QE1NDStWrCh6FG2kdu3a0blzZ9q0aVP0KJIaaDKmIuI+4EigY0TUAKOANgAppVuBR4HjgLnAMuDLm2tYSflqamrYeeedqaioIKKxo/QqRyklFi5cSE1NDV27di16HEkNNOfdfMOaeD4BXynZRJI2qxUrVhhSW6GIYI899sDzTaXy4xXQpW2QIbV18s9NKk/GlKQtbv78+fTq1WuzbPvpp5/m+OOPB2DcuHFce+21m+XrSNJqpTgBXdJWrOKy8SXd3vxrP1fS7eUYMmQIQ4YMKXoMSS2ce6YkFWLlypUMHz6cPn36cPLJJ7Ns2TIuv/xyBgwYQK9evRgxYgS1p2TCzTffTI8ePejTpw+nnnoqAEuXLuXss89mwIAB9OvXj4cffnidr3HHHXcwcuRIAM466ywuvvhiDjvsMPbbbz8eeOCB+vWuv/56BgwYQJ8+fRg1atQW+O4ltSTGlKRCvPjii4wYMYIZM2awyy678JOf/ISRI0cydepUXnjhBZYvX84jjzwCwLXXXkt1dTUzZszg1ltvBeCqq67i05/+NFOnTuWpp57iW9/6FkuXLt3g13z99deZNGkSjzzyCJdddhkAEyZM4KWXXuKvf/0r06dPZ9q0aUycOHHzfvOSWhRjSlIhunTpwuGHHw7A6aefzqRJk3jqqac4+OCD6d27N08++SQzZ84EoE+fPpx22mncfffdbLdd7dkJEyZM4Nprr6Vv374ceeSRrFixgldffXWDX/OEE06gVatW9OjRgzfeeKN+OxMmTKBfv37079+fOXPm8NJLL23G71xSS+M5U5IKsfY70yKCiy66iKqqKrp06cLo0aPrLyw6fvx4Jk6cyLhx47jiiiuYOXMmKSUefPBBPv7xj6+xndWR1Ji2bdvWf7z6EGJKiW9/+9ucf/75pfrWJG1j3DMlqRCvvvoqzz77LAD33XcfAwcOBKBjx44sWbKk/pymDz/8kAULFvCpT32K6667jnfeeYclS5Zw9NFH8+Mf/7g+iqqrqzdpjqOPPppf/vKXLFmyBIC///3vvPnmm7nfnqRtiHumJBWie/fu3HnnnZx//vl069aNCy+8kEWLFtG7d28qKioYMGAAAKtWreL0009n8eLFpJT4+te/zq677sp//ud/8rWvfY0+ffqQUqKioqL+HKuNcdRRRzF79mwOPfRQANq3b8/dd9/NnnvuWdLvV1LLFav/VbelVVZWpqqqqkK+trQtmz17Nt27dy96DG0i//ykYkTEtJRSZWPPeZhPkiQpgzElSZKUwXOmJGkzmVHzTvY2+rR6ec0H3nkTRh+y8RsavTh7FkmNc8+UJElSBmNKkiQpgzElSZKUwZiSJEnK4Ano0rZudIcSb2/TTnQePXo07du359JLL2XOnDmceuqpRAQPPPAA+++//xrrLliwgDPPPJN//OMftGrVihEjRnDJJZeUYnqpEBWXjS/Jdua3+1L+RnyzwkZzz5SksvPQQw8xdOhQqqur1wkpgO22244f/OAHzJ49mylTpnDLLbcwa9asAiaVJPdMSSrIXXfdxQ033EBE0KdPn/poevTRR7npppto3bo1EydO5Kmnnlrnc/faay/22msvAHbeeWe6d+/O3//+d3r06LFFvwdJAmNKUgFmzpzJVVddxeTJk+nYsSNvv/02N998MwDHHXccF1xwQf0hv6bMnz+f6upqDj744M09tiQ1ysN8kra4J598kpNPPpmOHTsCsPvuu2/SdpYsWcJJJ53ETTfdxC677FLKESWp2YwpSVtcSomIyNrGBx98wEknncRpp53GiSeeWKLJJGnjGVOStrjBgwczduxYFi5cCMDbb7+9UZ+fUuKcc86he/fufOMb39gcI0pSs3nOlLStK+Bt0D179uQ73/kOgwYNonXr1vTr14+Kiopmf/7kyZP51a9+Re/evenbty8AV199Nccdd9xmmliS1s+YojTX9yjJtT3A63uUOa8FUzrDhw9n+PDhjT43evToDX7uwIEDSSlthqlart539s7exthrVpZgEug+Z3ZJtiOVCw/zSZIkZXDPlKSytXDhQgYPHrzO40888QR77LFHARNJ0rqMKUlla4899mD69OlFjyFJG+RhPkmSpAzGlCRJUgZjSpIkKYPnTEnbuFK8Zb6hvw3/W0m31xwVFRVUVVXV355mazP12Unc+dMf81933F/0KJI2gXumJBUmpcSHH35Y9BhbzKpVq4oeQdJmYExJ2qLmz59P9+7dueiii+jfvz8LFizgwgsvpLKykp49ezJq1Kj6dSsqKhg1ahT9+/end+/ezJkzB6i9ZMJRRx1Fv379OP/889e4gOeNN95Ir1696NWrFzfddFP91/zEJz7BueeeS69evTjttNP44x//yOGHH063bt3461//us6cM2fO5KCDDqJv37706dOHl156CYC77767/vHzzz+/PpDW9z0ce2gfbr3pOoafeAwTHnmIV1+ex4hhJ/B/jhrIKccOYsH8lwFYvnQp3zx/OEOPPIhvf/U8L0oqbUWMKUlb3IsvvsiZZ55JdXU1++67L1dddRVVVVXMmDGDZ555hhkzZtSv27FjR5577jkuvPBCbrjhBgC+973vMXDgQKqrqxkyZAivvvoqANOmTeP222/nL3/5C1OmTOFnP/sZ1dXVAMydO5dLLrmEGTNmMGfOHO69914mTZrEDTfcwNVXX73OjLfeeiuXXHIJ06dPp6qqis6dOzN79mzuv/9+Jk+ezPTp02ndujX33HMPwAa/h7Zt23Lnb//AsUNP4tsXj+CUM8/lNxMmcdfvHqfjRz4CwJyZM/i/o6/md09OoebVV6ieOmXz/OZLKjljStIWt++++3LIIYfUL48dO5b+/fvTr18/Zs6cyaxZs+qfO/HEEwE48MADmT9/PgATJ07k9NNPB+Bzn/scu+22GwCTJk3iC1/4AjvttBPt27fnxBNP5E9/+hMAXbt2pXfv3rRq1YqePXsyePBgIoLevXvXb7ehQw89lKuvvprvf//7vPLKK+ywww488cQTTJs2jQEDBtC3b1+eeOIJ5s2b1+T3cPTnvwDA0iX/4s1/vM7gY48HoG27duyww44A9Op7IB/Za29atWrFx3v04rWaV7N/nyVtGZ6ALmmL22mnneo/fvnll7nhhhuYOnUqu+22G2eddRYrVqyof75t27YAtG7dmpUr//fecBGxznY3dGhs9XYAWrVqVb/cqlWrNba72pe+9CUOPvhgxo8fz9FHH83Pf/5zUkoMHz6ca665Zo11m/oedthxpybna7P99v87X+vWrFrp+VXS1sI9U5IK9e6777LTTjvRoUMH3njjDR577LEmP+eII46oP7z22GOPsWjRovrHH3roIZYtW8bSpUv53e9+xyc/+clNmmvevHnst99+XHzxxQwZMoQZM2YwePBgHnjgAd58800A3n77bV555ZVmfw/td96Fj+z1UZ78Q+0Ns99/7z2WL1+2SfNJKh/umZK2cUVcyqChAw44gH79+tGzZ0/2228/Dj/88CY/Z9SoUQwbNoz+/fszaNAg9tlnHwD69+/PWWedxUEHHQTAueeeS79+/Ro9jNeU+++/n7vvvps2bdrwb//2b3z3u99l991358orr+Soo47iww8/pE2bNtxyyy0ccsghzf4ervrRrVxx2df5yQ+uZrs2bbhhzB0bPZuk8hJFvWOksrIyVVVVFfK111Zx2fjsbcxv96USTAKMXlya7WizKMVrBUr0etnE18rs2bPp3r17/tdXk2bUvJO9jT6tXl5jefYrb9L98S9u9HZ6d90ne5ax16x7OHRTdJ8zuyTbaUlaws+Wli4ipqWUKht7zsN8kiRJGYwpSZKkDMaUJElSBmNKkiQpgzElSZKUwZiSJEnK4HWmpG3c7E+U9jIJpXzb+6233sqOO+7ImWeeucbj8+fP5/jjj+eFF14o2dfaWOUwg6TyYExJKksrV67kggsuKHoMVq5cyXbb+aNS0vr5E0LSFnfFFVdwzz330KVLFzp27MiBBx7IpZdeypFHHslhhx3G5MmTGTJkCP/6179o3749l156KdOmTePss89mxx13ZODAgY1u9/XXX+eUU07h3XffZeXKlYwZM4ZPfvKTTJgwgVGjRvHee++x//77c/vtt9O+fXsuv/xyfv/737N8+XIOO+wwfvrTnxIR68xx+umnc8EFF9Tf1HjMmDF89KMfZdWqVZx33nn8+c9/Zu+99+bhhx9mhx122JK/lZLKgOdMSdqiqqqqePDBB6murua3v/0ta98J4Z133uGZZ57hm9/85hqPf/nLX+bmm2/m2WefXe+27733Xo4++mimT5/O888/T9++ffnnP//JlVdeyR//+Eeee+45KisrufHGGwEYOXIkU6dO5YUXXmD58uU88sgjjc5x8cUXM2jQIJ5//nmee+45evbsCcBLL73EV77yFWbOnMmuu+7Kgw8+WKrfJklbEfdMSdqiJk2axNChQ+v34Hz+859f4/lTTjllnc9ZvHgx77zzDoMGDQLgjDPOaPRmwgMGDODss8/mgw8+4IQTTqBv374888wzzJo1q/5+ee+//z6HHnooAE899RTXXXcdy5Yt4+2336Znz5718zSc48knn+Suu+4CoHXr1nTo0IFFixbRtWtX+vbtC8CBBx64SfcAlLT1M6YkbVFN3Q90p512avRzIqLJbR9xxBFMnDiR8ePHc8YZZ/Ctb32L3Xbbjc9+9rPcd999a6y7YsUKLrroIqqqqujSpQujR49mxYoVG5xjbW3btq3/uHXr1ixfvrzJz5HU8niYT9IWNXDgQH7/+9+zYsUKlixZwvjxTd/gddddd6VDhw5MmjQJgHvuuafR9V555RX23HNPzjvvPM455xyee+45DjnkECZPnszcuXMBWLZsGf/zP/9TH04dO3ZkyZIlPPDAA+v9+oMHD2bMmDEArFq1infffXejvmdJLZt7pqRtXCkvZdAcAwYMYMiQIRxwwAHsu+++VFZW0qFDhyY/7/bbb68/Af3oo49udJ2nn36a66+/njZt2tC+fXvuuusuOnXqxB133MGwYcN47733ALjyyiv52Mc+xnnnnUfv3r2pqKhgwIAB6/3aP/rRjxgxYgS/+MUvaN26NWPGjGGvvfbatN8ASS1ONLXLfXOprKxMa594WpSKy5r+l3FT5rf7UgkmAUYvLs12tFmU4rUCJXq9bOJrZfbs2XTvXtprS22sJUuW0L59e5YtW8YRRxzBbbfdRv/+/QudaXOYUfNO9jb6tHp5jeXZr7xJ98e/uNHb6d11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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Saving-and-loading-machine-learning-models">Saving and loading machine learning models<a class="anchor-link" href="#Saving-and-loading-machine-learning-models"> </a></h2><p>There are two ways to save and load machine learning models:</p>
<ol>
<li>With Python's <code>Pickle</code> module</li>
<li>With the <code>joblib</code> module</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Pickle</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>

<span class="c1"># Save an existing model to file</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">gs_clf</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;gs_random_forest_model_1.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Load a saved model</span>
<span class="n">loaded_pickle_model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;gs_random_forest_model_1.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Make some predictions</span>
<span class="n">pickle_y_preds</span> <span class="o">=</span> <span class="n">loaded_pickle_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">evaluate_preds</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pickle_y_preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Acc: 85.25%
Precision: 0.79
Recall: 0.93
F1 score: 0.86
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;accuracy&#39;: 0.85, &#39;precision&#39;: 0.79, &#39;recall&#39;: 0.93, &#39;f1&#39;: 0.86}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We know the model is the same one if the accuracy remains the same.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Joblib</strong></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">dump</span><span class="p">,</span> <span class="n">load</span>

<span class="c1"># Save a model to file</span>
<span class="n">dump</span><span class="p">(</span><span class="n">gs_clf</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="s2">&quot;gs_random_forest_model_1.joblib&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;gs_random_forest_model_1.joblib&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import a saved joblib model</span>
<span class="n">loaded_joblib_model</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;gs_random_forest_model_1.joblib&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Make and evaluate joblib predictions</span>
<span class="n">joblib_y_preds</span> <span class="o">=</span> <span class="n">loaded_joblib_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">evaluate_preds</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">joblib_y_preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Acc: 85.25%
Precision: 0.79
Recall: 0.93
F1 score: 0.86
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;accuracy&#39;: 0.85, &#39;precision&#39;: 0.79, &#39;recall&#39;: 0.93, &#39;f1&#39;: 0.86}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Putting-it-all-together!">Putting it all together!<a class="anchor-link" href="#Putting-it-all-together!"> </a></h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/CongLiu-CN/zero-to-mastery-ml/master/data/car-sales-extended-missing-data.csv&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Make</th>
      <th>Colour</th>
      <th>Odometer (KM)</th>
      <th>Doors</th>
      <th>Price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Honda</td>
      <td>White</td>
      <td>35431.0</td>
      <td>4.0</td>
      <td>15323.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BMW</td>
      <td>Blue</td>
      <td>192714.0</td>
      <td>5.0</td>
      <td>19943.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Honda</td>
      <td>White</td>
      <td>84714.0</td>
      <td>4.0</td>
      <td>28343.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Toyota</td>
      <td>White</td>
      <td>154365.0</td>
      <td>4.0</td>
      <td>13434.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nissan</td>
      <td>Blue</td>
      <td>181577.0</td>
      <td>3.0</td>
      <td>14043.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>Toyota</td>
      <td>Black</td>
      <td>35820.0</td>
      <td>4.0</td>
      <td>32042.0</td>
    </tr>
    <tr>
      <th>996</th>
      <td>NaN</td>
      <td>White</td>
      <td>155144.0</td>
      <td>3.0</td>
      <td>5716.0</td>
    </tr>
    <tr>
      <th>997</th>
      <td>Nissan</td>
      <td>Blue</td>
      <td>66604.0</td>
      <td>4.0</td>
      <td>31570.0</td>
    </tr>
    <tr>
      <th>998</th>
      <td>Honda</td>
      <td>White</td>
      <td>215883.0</td>
      <td>4.0</td>
      <td>4001.0</td>
    </tr>
    <tr>
      <th>999</th>
      <td>Toyota</td>
      <td>Blue</td>
      <td>248360.0</td>
      <td>4.0</td>
      <td>12732.0</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 5 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Make              object
Colour            object
Odometer (KM)    float64
Doors            float64
Price            float64
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Make             49
Colour           50
Odometer (KM)    50
Doors            50
Price            50
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Steps we want to do (all in one cell):</p>
<ol>
<li>Fill missing data</li>
<li>Convert data to numbers</li>
<li>Build a model on the data</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Getting data ready</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>

<span class="c1"># Modelling</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GridSearchCV</span>

<span class="c1"># Setup random seed</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>

<span class="c1"># Import data and drop rows with missing labels</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/CongLiu-CN/zero-to-mastery-ml/master/data/car-sales-extended-missing-data.csv&quot;</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Price&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Define different features and transformer pipeline</span>
<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Make&quot;</span><span class="p">,</span> <span class="s2">&quot;Colour&quot;</span><span class="p">]</span>
<span class="n">categorical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;imputer&quot;</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;missing&quot;</span><span class="p">)),</span>
    <span class="p">(</span><span class="s2">&quot;onehot&quot;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">))</span>
<span class="p">])</span>

<span class="n">door_feature</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Doors&quot;</span><span class="p">]</span>
<span class="n">door_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;imputer&quot;</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
<span class="p">])</span>

<span class="n">numeric_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Odometer (KM)&quot;</span><span class="p">]</span>
<span class="n">numeric_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;imputer&quot;</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">))</span>
<span class="p">])</span>

<span class="c1"># Setup preprocessing steps (fill missing values, then convert to numbers)</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
               <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
                   <span class="p">(</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="n">categorical_transformer</span><span class="p">,</span> <span class="n">categorical_features</span><span class="p">),</span>
                   <span class="p">(</span><span class="s2">&quot;door&quot;</span><span class="p">,</span> <span class="n">door_transformer</span><span class="p">,</span> <span class="n">door_feature</span><span class="p">),</span>
                   <span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">)</span>
               <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Creating a preprocessing and modelling pipleline</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">RandomForestRegressor</span><span class="p">())</span>
<span class="p">])</span>

<span class="c1"># Split data</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Price&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;Price&quot;</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># Fit and score the model</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.09943714170819874</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's also possible to use <code>GridSearchCV</code> or <code>RandomizedSearchCV</code> with our <code>Pipeline</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Use GridSearchCV with our regression Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="n">pipe_grid</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;preprocessor__num__imputer__strategy&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="s2">&quot;median&quot;</span><span class="p">],</span>
    <span class="s2">&quot;model__n_estimators&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="s2">&quot;model__max_depth&quot;</span><span class="p">:</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="s2">&quot;model__max_features&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;auto&quot;</span><span class="p">],</span>
    <span class="s2">&quot;model__min_samples_split&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>    
<span class="p">}</span>

<span class="n">gs_model</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">pipe_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">gs_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Fitting 5 folds for each of 16 candidates, totalling 80 fits
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=1)]: Done   1 out of   1 | elapsed:    0.3s remaining:    0.0s
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   3.7s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   3.5s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   3.5s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   3.3s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   3.3s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   3.3s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   3.2s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   3.6s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   3.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   3.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.3s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.3s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.3s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.3s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.3s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.4s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   3.0s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   3.0s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   2.9s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   3.0s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   3.1s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   3.0s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   2.9s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   2.9s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   3.2s
[CV] model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=None, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   3.0s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   2.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   2.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   2.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   2.4s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   2.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   2.1s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   2.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   2.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   2.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=2, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   2.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=mean, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=100, preprocessor__num__imputer__strategy=median, total=   0.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   2.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   2.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   2.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   2.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=mean, total=   2.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   2.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   2.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   2.2s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   2.3s
[CV] model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median 
[CV]  model__max_depth=5, model__max_features=auto, model__min_samples_split=4, model__n_estimators=1000, preprocessor__num__imputer__strategy=median, total=   2.3s
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=1)]: Done  80 out of  80 | elapsed:  2.0min finished
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>GridSearchCV(cv=5, error_score=nan,
             estimator=Pipeline(memory=None,
                                steps=[(&#39;preprocessor&#39;,
                                        ColumnTransformer(n_jobs=None,
                                                          remainder=&#39;drop&#39;,
                                                          sparse_threshold=0.3,
                                                          transformer_weights=None,
                                                          transformers=[(&#39;cat&#39;,
                                                                         Pipeline(memory=None,
                                                                                  steps=[(&#39;imputer&#39;,
                                                                                          SimpleImputer(add_indicator=False,
                                                                                                        copy=True,
                                                                                                        fill_value=&#39;missing&#39;,
                                                                                                        missing_values=nan,
                                                                                                        strategy=&#39;constant&#39;,
                                                                                                        verbo...
                                                              verbose=0,
                                                              warm_start=False))],
                                verbose=False),
             iid=&#39;deprecated&#39;, n_jobs=None,
             param_grid={&#39;model__max_depth&#39;: [None, 5],
                         &#39;model__max_features&#39;: [&#39;auto&#39;],
                         &#39;model__min_samples_split&#39;: [2, 4],
                         &#39;model__n_estimators&#39;: [100, 1000],
                         &#39;preprocessor__num__imputer__strategy&#39;: [&#39;mean&#39;,
                                                                  &#39;median&#39;]},
             pre_dispatch=&#39;2*n_jobs&#39;, refit=True, return_train_score=False,
             scoring=None, verbose=2)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gs_model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.22706234528702576</pre>
</div>

</div>

</div>
</div>

</div>
    

</div>



  </div><a class="u-url" href="/2020/04/16/Improve-a-model.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Cong Liu&#39;s blog</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/CongLiu-CN" title="CongLiu-CN"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/tsong_liu" title="tsong_liu"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
