<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Scikit-Learn Practice Exercises | Cong Liu 刘聪</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Scikit-Learn Practice Exercises" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This notebook offers a set of excercises for different tasks with Scikit-Learn." />
<meta property="og:description" content="This notebook offers a set of excercises for different tasks with Scikit-Learn." />
<link rel="canonical" href="https://www.liucong.ca/2020/04/28/Scikit-learn-exercises.html" />
<meta property="og:url" content="https://www.liucong.ca/2020/04/28/Scikit-learn-exercises.html" />
<meta property="og:site_name" content="Cong Liu 刘聪" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-28T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"This notebook offers a set of excercises for different tasks with Scikit-Learn.","@type":"BlogPosting","headline":"Scikit-Learn Practice Exercises","dateModified":"2020-04-28T00:00:00-05:00","datePublished":"2020-04-28T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.liucong.ca/2020/04/28/Scikit-learn-exercises.html"},"url":"https://www.liucong.ca/2020/04/28/Scikit-learn-exercises.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://www.liucong.ca/feed.xml" title="Cong Liu | 刘聪" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Scikit-Learn Practice Exercises | Cong Liu 刘聪</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Scikit-Learn Practice Exercises" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This notebook offers a set of excercises for different tasks with Scikit-Learn." />
<meta property="og:description" content="This notebook offers a set of excercises for different tasks with Scikit-Learn." />
<link rel="canonical" href="https://www.liucong.ca/2020/04/28/Scikit-learn-exercises.html" />
<meta property="og:url" content="https://www.liucong.ca/2020/04/28/Scikit-learn-exercises.html" />
<meta property="og:site_name" content="Cong Liu 刘聪" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-28T00:00:00-05:00" />
<script type="application/ld+json">
{"description":"This notebook offers a set of excercises for different tasks with Scikit-Learn.","@type":"BlogPosting","headline":"Scikit-Learn Practice Exercises","dateModified":"2020-04-28T00:00:00-05:00","datePublished":"2020-04-28T00:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.liucong.ca/2020/04/28/Scikit-learn-exercises.html"},"url":"https://www.liucong.ca/2020/04/28/Scikit-learn-exercises.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://www.liucong.ca/feed.xml" title="Cong Liu | 刘聪" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Cong Liu | 刘聪</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Scikit-Learn Practice Exercises</h1><p class="page-description">This notebook offers a set of excercises for different tasks with Scikit-Learn.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-04-28T00:00:00-05:00" itemprop="datePublished">
        Apr 28, 2020
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      30 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/CongLiu-CN/AIisLove/tree/master/_notebooks/2020-04-28-Scikit-learn-exercises.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/CongLiu-CN/AIisLove/master?filepath=_notebooks%2F2020-04-28-Scikit-learn-exercises.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/CongLiu-CN/AIisLove/blob/master/_notebooks/2020-04-28-Scikit-learn-exercises.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-04-28-Scikit-learn-exercises.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Setup matplotlib to plot inline (within the notebook)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Import the pyplot module of Matplotlib as plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Import pandas under the abbreviation &#39;pd&#39;</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Import NumPy under the abbreviation &#39;np&#39;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="End-to-end-Scikit-Learn-classification-workflow">End-to-end Scikit-Learn classification workflow<a class="anchor-link" href="#End-to-end-Scikit-Learn-classification-workflow"> </a></h2><p>Let's start with an end to end Scikit-Learn workflow.</p>
<p>More specifically, we'll:</p>
<ol>
<li>Get a dataset ready</li>
<li>Prepare a machine learning model to make predictions</li>
<li>Fit the model to the data and make a prediction</li>
<li>Evaluate the model's predictions </li>
</ol>
<p>The data we'll be using is <a href="https://github.com/mrdbourke/zero-to-mastery-ml/tree/master/data">stored on GitHub</a>. We'll start with <code>heart-disease.csv</code>, a dataset which contains anonymous patient data and whether or not they have heart disease.</p>
<p><strong>Note:</strong> When viewing a <code>.csv</code> on GitHub, make sure it's in the raw format. For example, the URL should look like: <a href="https://raw.githubusercontent.com/mrdbourke/zero-to-mastery-ml/master/data/heart-disease.csv">https://raw.githubusercontent.com/mrdbourke/zero-to-mastery-ml/master/data/heart-disease.csv</a></p>
<h3 id="1.-Getting-a-dataset-ready">1. Getting a dataset ready<a class="anchor-link" href="#1.-Getting-a-dataset-ready"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import the heart disease dataset and save it to a variable</span>
<span class="c1"># using pandas and read_csv()</span>
<span class="c1"># Hint: You can directly pass the URL of a csv to read_csv()</span>
<span class="n">heart_disease</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/CongLiu-CN/zero-to-mastery-ml/master/data/heart-disease.csv&quot;</span><span class="p">)</span>

<span class="c1"># Check the first 5 rows of the data</span>
<span class="n">heart_disease</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age</th>
      <th>sex</th>
      <th>cp</th>
      <th>trestbps</th>
      <th>chol</th>
      <th>fbs</th>
      <th>restecg</th>
      <th>thalach</th>
      <th>exang</th>
      <th>oldpeak</th>
      <th>slope</th>
      <th>ca</th>
      <th>thal</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63</td>
      <td>1</td>
      <td>3</td>
      <td>145</td>
      <td>233</td>
      <td>1</td>
      <td>0</td>
      <td>150</td>
      <td>0</td>
      <td>2.3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>37</td>
      <td>1</td>
      <td>2</td>
      <td>130</td>
      <td>250</td>
      <td>0</td>
      <td>1</td>
      <td>187</td>
      <td>0</td>
      <td>3.5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>41</td>
      <td>0</td>
      <td>1</td>
      <td>130</td>
      <td>204</td>
      <td>0</td>
      <td>0</td>
      <td>172</td>
      <td>0</td>
      <td>1.4</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>56</td>
      <td>1</td>
      <td>1</td>
      <td>120</td>
      <td>236</td>
      <td>0</td>
      <td>1</td>
      <td>178</td>
      <td>0</td>
      <td>0.8</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>57</td>
      <td>0</td>
      <td>0</td>
      <td>120</td>
      <td>354</td>
      <td>0</td>
      <td>1</td>
      <td>163</td>
      <td>1</td>
      <td>0.6</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our goal here is to build a machine learning model on all of the columns except <code>target</code> to predict <code>target</code>.</p>
<p>In essence, the <code>target</code> column is our <strong>target variable</strong> (also called <code>y</code> or <code>labels</code>) and the rest of the other columns are our independent variables (also called <code>data</code> or <code>X</code>).</p>
<p>And since our target variable is one thing or another (heart disease or not), we know our problem is a classification problem (classifying whether something is one thing or another).</p>
<p>Knowing this, let's create <code>X</code> and <code>y</code> by splitting our dataframe up.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create X (all columns except target)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">heart_disease</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;target&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create y (only the target column)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">heart_disease</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we've split our data into <code>X</code> and <code>y</code>, we'll use Scikit-Learn to split it into training and test sets.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import train_test_split from sklearn&#39;s model_selection module</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Use train_test_split to split X &amp; y into training and test sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># View the different shapes of the training and test datasets</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((227, 13), (76, 13), (227,), (76,))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What do you notice about the different shapes of the data?</p>
<p>Since our data is now in training and test sets, we'll build a machine learning model to fit patterns in the training data and then make predictions on the test data.</p>
<p>To figure out which machine learning model we should use, you can refer to <a href="https://scikit-learn.org/stable/tutorial/machine_learning_map/index.html">Scikit-Learn's machine learning map</a>.</p>
<p>After following the map, you decide to use the <code>RandomForestClassifier</code>.</p>
<h3 id="2.-Preparing-a-machine-learning-model">2. Preparing a machine learning model<a class="anchor-link" href="#2.-Preparing-a-machine-learning-model"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import the RandomForestClassifier from sklearn&#39;s ensemble module</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>

<span class="c1"># Instantiate an instance of RandomForestClassifier as clf</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now you've got a <code>RandomForestClassifier</code> instance, let's fit it to the training data.</p>
<p>Once it's fit, we'll make predictions on the test data.</p>
<h3 id="3.-Fitting-a-model-and-making-predictions">3. Fitting a model and making predictions<a class="anchor-link" href="#3.-Fitting-a-model-and-making-predictions"> </a></h3>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Fit the RandomForestClassifier to the training data</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, ccp_alpha=0.0, class_weight=None,
                       criterion=&#39;gini&#39;, max_depth=None, max_features=&#39;auto&#39;,
                       max_leaf_nodes=None, max_samples=None,
                       min_impurity_decrease=0.0, min_impurity_split=None,
                       min_samples_leaf=1, min_samples_split=2,
                       min_weight_fraction_leaf=0.0, n_estimators=100,
                       n_jobs=None, oob_score=False, random_state=None,
                       verbose=0, warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Use the fitted model to make predictions on the test data and</span>
<span class="c1"># save the predictions to a variable called y_preds</span>
<span class="n">y_preds</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="4.-Evaluating-a-model's-predictions">4. Evaluating a model's predictions<a class="anchor-link" href="#4.-Evaluating-a-model's-predictions"> </a></h3><p>Evaluating predictions is as important making them. Let's check how our model did by comparing the predictions it made on the test data (<code>y_preds</code>) to the ground truth labels (<code>y_test</code>).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Evaluate the fitted model on the training set using the score() function</span>
<span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1.0</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Evaluate the fitted model on the test set using the score() function</span>
<span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8289473684210527</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>How did you model go? </li>
<li>What metric does <code>score()</code> return for classifiers? </li>
<li>Did your model do better on the training dataset or test dataset?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Experimenting-with-different-classification-models">Experimenting with different classification models<a class="anchor-link" href="#Experimenting-with-different-classification-models"> </a></h2><p>Now we've quickly covered an end-to-end Scikit-Learn workflow and since experimenting is a large part of machine learning, we'll now try a series of different machine learning models and see which gets the best results on our dataset.</p>
<p>Going through the <a href="https://scikit-learn.org/stable/tutorial/machine_learning_map/index.html">Scikit-Learn machine learning map</a>, we see there are a number of different classification models we can try (different models are in the green boxes).</p>
<p>For this exercise, the models we're going to try and compare are:</p>
<ul>
<li><a href="https://scikit-learn.org/stable/modules/svm.html#classification">LinearSVC</a></li>
<li><a href="https://scikit-learn.org/stable/modules/neighbors.html">KNeighborsClassifier</a> (also known as K-Nearest Neighbors or KNN)</li>
<li><a href="https://scikit-learn.org/stable/modules/svm.html#classification">SVC</a> (also known as support vector classifier, a form of <a href="https://en.wikipedia.org/wiki/Support-vector_machine">support vector machine</a>)</li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html">LogisticRegression</a> (despite the name, this is actually a classifier)</li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html">RandomForestClassifier</a> (an ensemble method and what we used above)</li>
</ul>
<p>We'll follow the same workflow we used above (except this time for multiple models):</p>
<ol>
<li>Import a machine learning model</li>
<li>Get it ready</li>
<li>Fit it to the data and make predictions</li>
<li>Evaluate the fitted model</li>
</ol>
<p><strong>Note:</strong> Since we've already got the data ready, we can reuse it in this section.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import LinearSVC from sklearn&#39;s svm module</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">LinearSVC</span>

<span class="c1"># Import KNeighborsClassifier from sklearn&#39;s neighbors module</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>

<span class="c1"># Import SVC from sklearn&#39;s svm module</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>

<span class="c1"># Import LogisticRegression from sklearn&#39;s linear_model module</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>

<span class="c1"># Note: we don&#39;t have to import RandomForestClassifier, since we already have</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thanks to the consistency of Scikit-Learn's API design, we can use virtually the same code to fit, score and make predictions with each of our models.</p>
<p>To see which model performs best, we'll do the following:</p>
<ol>
<li>Instantiate each model in a dictionary</li>
<li>Create an empty results dictionary</li>
<li>Fit each model on the training data</li>
<li>Score each model on the test data</li>
<li>Check the results</li>
</ol>
<p>If you're wondering what it means to instantiate each model in a dictionary, see the example below.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># EXAMPLE: Instantiating a RandomForestClassifier() in a dictionary</span>
<span class="n">example_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;RandomForestClassifier&quot;</span><span class="p">:</span> <span class="n">RandomForestClassifier</span><span class="p">()}</span>

<span class="c1"># Create a dictionary called models which contains all of the classification models we&#39;ve imported</span>
<span class="c1"># Make sure the dictionary is in the same format as example_dict</span>
<span class="c1"># The models dictionary should contain 5 models</span>
<span class="n">models</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;LinearSVC&quot;</span><span class="p">:</span> <span class="n">LinearSVC</span><span class="p">(),</span>
          <span class="s2">&quot;KNN&quot;</span><span class="p">:</span> <span class="n">KNeighborsClassifier</span><span class="p">(),</span>
          <span class="s2">&quot;SVC&quot;</span><span class="p">:</span> <span class="n">SVC</span><span class="p">(),</span>
          <span class="s2">&quot;LogisticRegression&quot;</span><span class="p">:</span> <span class="n">LogisticRegression</span><span class="p">(),</span>
          <span class="s2">&quot;RandomForestClassifier&quot;</span><span class="p">:</span> <span class="n">RandomForestClassifier</span><span class="p">()}</span>

<span class="c1"># Create an empty dictionary called results</span>
<span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since each model we're using has the same <code>fit()</code> and <code>score()</code> functions, we can loop through our models dictionary and, call <code>fit()</code> on the training data and then call <code>score()</code> with the test data.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># EXAMPLE: Looping through example_dict fitting and scoring the model</span>
<span class="n">example_results</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">example_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">example_results</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="c1"># EXAMPLE: View the results</span>
<span class="n">example_results</span>    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;RandomForestClassifier&#39;: 0.8552631578947368}</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Loop through the models dictionary items, fitting the model on the training data</span>
<span class="c1"># and appending the model name and model score on the test data to the results dictionary</span>
<span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

<span class="c1"># View the results</span>
<span class="n">results</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Users\LC\machine_learning\env\lib\site-packages\sklearn\svm\_base.py:946: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.
  warnings.warn(&#34;Liblinear failed to converge, increase &#34;
C:\Users\LC\machine_learning\env\lib\site-packages\sklearn\linear_model\_logistic.py:938: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;LinearSVC&#39;: 0.6842105263157895,
 &#39;KNN&#39;: 0.6973684210526315,
 &#39;SVC&#39;: 0.6973684210526315,
 &#39;LogisticRegression&#39;: 0.881578947368421,
 &#39;RandomForestClassifier&#39;: 0.8552631578947368}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Which model performed the best? </li>
<li>Do the results change each time you run the cell? </li>
<li>Why do you think this is?</li>
</ul>
<p>Due to the randomness of how each model finds patterns in the data, you might notice different results each time.</p>
<p>Without manually setting the random state using the <code>random_state</code> parameter of some models or using a NumPy random seed, every time you run the cell, you'll get slightly different results.</p>
<p>Let's see this in effect by running the same code as the cell above, except this time setting a <a href="https://docs.scipy.org/doc/numpy-1.15.1/reference/generated/numpy.random.seed.html">NumPy random seed equal to 42</a>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Run the same code as the cell above, except this time set a NumPy random seed</span>
<span class="c1"># equal to 42</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    
<span class="n">results</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>C:\Users\LC\machine_learning\env\lib\site-packages\sklearn\svm\_base.py:946: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.
  warnings.warn(&#34;Liblinear failed to converge, increase &#34;
C:\Users\LC\machine_learning\env\lib\site-packages\sklearn\linear_model\_logistic.py:938: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;LinearSVC&#39;: 0.4605263157894737,
 &#39;KNN&#39;: 0.6973684210526315,
 &#39;SVC&#39;: 0.6973684210526315,
 &#39;LogisticRegression&#39;: 0.881578947368421,
 &#39;RandomForestClassifier&#39;: 0.8157894736842105}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Run the cell above a few times, what do you notice about the results? </li>
<li>Which model performs the best this time?</li>
<li>What happens if you add a NumPy random seed to the cell where you called <code>train_test_split()</code> (towards the top of the notebook) and then rerun the cell above?</li>
</ul>
<p>Let's make our results a little more visual.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a pandas dataframe with the data as the values of the results dictionary,</span>
<span class="c1"># the index as the keys of the results dictionary and a single column called accuracy.</span>
<span class="c1"># Be sure to save the dataframe to a variable.</span>
<span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> 
                          <span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> 
                          <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">])</span>

<span class="c1"># Create a bar plot of the results dataframe using plot.bar()</span>
<span class="n">results_df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using <code>np.random.seed(42)</code> results in the <code>LogisticRegression</code> model perfoming the best (at least on my computer).</p>
<p>Let's tune its hyperparameters and see if we can improve it.</p>
<h3 id="Hyperparameter-Tuning">Hyperparameter Tuning<a class="anchor-link" href="#Hyperparameter-Tuning"> </a></h3><p>Remember, if you're ever trying to tune a machine learning models hyperparameters and you're not sure where to start, you can always search something like "MODEL_NAME hyperparameter tuning".</p>
<p>In the case of LogisticRegression, you might come across articles, such as <a href="https://chrisalbon.com/machine_learning/model_selection/hyperparameter_tuning_using_grid_search/">Hyperparameter Tuning Using Grid Search by Chris Albon</a>.</p>
<p>The article uses <code>GridSearchCV</code> but we're going to be using <code>RandomizedSearchCV</code>.</p>
<p>The different hyperparameters to search over have been setup for you in <code>log_reg_grid</code> but feel free to change them.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Different LogisticRegression hyperparameters</span>
<span class="n">log_reg_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
                <span class="s2">&quot;solver&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;liblinear&quot;</span><span class="p">]}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we've got a set of hyperparameters we can import <code>RandomizedSearchCV</code>, pass it our dictionary of hyperparameters and let it search for the best combination.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Setup np random seed of 42</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Import RandomizedSearchCV from sklearn&#39;s model_selection module</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">RandomizedSearchCV</span>

<span class="c1"># Setup an instance of RandomizedSearchCV with a LogisticRegression() estimator,</span>
<span class="c1"># our log_reg_grid as the param_distributions, a cv of 5 and n_iter of 5.</span>
<span class="n">rs_log_reg</span> <span class="o">=</span> <span class="n">RandomizedSearchCV</span><span class="p">(</span><span class="n">estimator</span><span class="o">=</span><span class="n">LogisticRegression</span><span class="p">(),</span>
                                <span class="n">param_distributions</span><span class="o">=</span><span class="n">log_reg_grid</span><span class="p">,</span>
                                <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">n_iter</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Fit the instance of RandomizedSearchCV</span>
<span class="n">rs_log_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Fitting 5 folds for each of 5 candidates, totalling 25 fits
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>[Parallel(n_jobs=1)]: Using backend SequentialBackend with 1 concurrent workers.
[Parallel(n_jobs=1)]: Done  25 out of  25 | elapsed:    0.1s finished
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once <code>RandomizedSearchCV</code> has finished, we can find the best hyperparmeters it found using the <code>best_params_</code> attributes.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find the best parameters of the RandomizedSearchCV instance using the best_params_ attribute</span>
<span class="n">rs_log_reg</span><span class="o">.</span><span class="n">best_params_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;solver&#39;: &#39;liblinear&#39;, &#39;C&#39;: 0.23357214690901212}</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Score the instance of RandomizedSearchCV using the test data</span>
<span class="n">rs_log_reg</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8947368421052632</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After hyperparameter tuning, did the models score improve? What else could you try to improve it? Are there any other methods of hyperparameter tuning you can find for <code>LogisticRegression</code>?</p>
<h3 id="Classifier-Model-Evaluation">Classifier Model Evaluation<a class="anchor-link" href="#Classifier-Model-Evaluation"> </a></h3><p>We've tried to find the best hyperparameters on our model using <code>RandomizedSearchCV</code> and so far we've only been evaluating our model using the <code>score()</code> function which returns accuracy.</p>
<p>But when it comes to classification, you'll likely want to use a few more evaluation metrics, including:</p>
<ul>
<li><a href="https://www.dataschool.io/simple-guide-to-confusion-matrix-terminology/"><strong>Confusion matrix</strong></a> - Compares the predicted values with the true values in a tabular way, if 100% correct, all values in the matrix will be top left to bottom right (diagnol line).</li>
<li><a href="https://scikit-learn.org/stable/modules/cross_validation.html"><strong>Cross-validation</strong></a> - Splits your dataset into multiple parts and train and tests your model on each part and evaluates performance as an average. </li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.precision_score.html#sklearn.metrics.precision_score"><strong>Precision</strong></a> - Proportion of true positives over total number of samples. Higher precision leads to less false positives.</li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.recall_score.html#sklearn.metrics.recall_score"><strong>Recall</strong></a> - Proportion of true positives over total number of true positives and false positives. Higher recall leads to less false negatives.</li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html#sklearn.metrics.f1_score"><strong>F1 score</strong></a> - Combines precision and recall into one metric. 1 is best, 0 is worst.</li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html"><strong>Classification report</strong></a> - Sklearn has a built-in function called <code>classification_report()</code> which returns some of the main classification metrics such as precision, recall and f1-score.</li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_score.html"><strong>ROC Curve</strong></a> - <a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic">Receiver Operating Characterisitc</a> is a plot of true positive rate versus false positive rate.</li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html"><strong>Area Under Curve (AUC)</strong></a> - The area underneath the ROC curve. A perfect model achieves a score of 1.0.</li>
</ul>
<p>Before we get to these, we'll instantiate a new instance of our model using the best hyerparameters found by <code>RandomizedSearchCV</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Instantiate a LogisticRegression classifier using the best hyperparameters from RandomizedSearchCV</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s2">&quot;liblinear&quot;</span><span class="p">,</span> <span class="n">C</span><span class="o">=</span><span class="mf">0.23357214690901212</span><span class="p">)</span>

<span class="c1"># Fit the new instance of LogisticRegression with the best hyperparameters on the training data </span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now it's to import the relative Scikit-Learn methods for each of the classification evaluation metrics we're after.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import confusion_matrix and classification_report from sklearn&#39;s metrics module</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">classification_report</span>

<span class="c1"># Import precision_score, recall_score and f1_score from sklearn&#39;s metrics module</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>

<span class="c1"># Import plot_roc_curve from sklearn&#39;s metrics module</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">plot_roc_curve</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Evaluation metrics are very often comparing a model's predictions to some ground truth labels.</p>
<p>Let's make some predictions on the test data using our latest model and save them to <code>y_preds</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Make predictions on test data and save them</span>
<span class="n">y_preds</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Time to use the predictions our model has made to evaluate it beyond accuracy.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a confusion matrix using the confusion_matrix function</span>
<span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[30,  5],
       [ 3, 38]], dtype=int64)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Challenge:</strong> The in-built <code>confusion_matrix</code> function in Scikit-Learn produces something not too visual, how could you make your confusion matrix more visual?</p>
<p>You might want to search something like "how to plot a confusion matrix". Note: There may be more than one way to do this.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="o">!</span>conda install --yes --prefix <span class="o">{</span>sys.prefix<span class="o">}</span> seaborn
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting package metadata (current_repodata.json): ...working... done</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>

==&gt; WARNING: A newer version of conda exists. &lt;==
  current version: 4.8.2
  latest version: 4.8.3

Please update conda by running

    $ conda update -n base -c defaults conda


</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
Solving environment: ...working... done

## Package Plan ##

  environment location: C:\Users\LC\machine_learning\env

  added / updated specs:
    - seaborn


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    seaborn-0.10.0             |             py_0         163 KB
    ------------------------------------------------------------
                                           Total:         163 KB

The following NEW packages will be INSTALLED:

  seaborn            pkgs/main/noarch::seaborn-0.10.0-py_0



Downloading and Extracting Packages

seaborn-0.10.0       | 163 KB    |            |   0% 
seaborn-0.10.0       | 163 KB    | 9          |  10% 
seaborn-0.10.0       | 163 KB    | ###9       |  39% 
seaborn-0.10.0       | 163 KB    | ####9      |  49% 
seaborn-0.10.0       | 163 KB    | ########## | 100% 
Preparing transaction: ...working... done
Verifying transaction: ...working... done
Executing transaction: ...working... done
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a more visual confusion matrix</span>
<span class="c1"># Import seaborn for improving visualisaztion of confusion matrix</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># Make confusion matrix more visual</span>
<span class="k">def</span> <span class="nf">plot_conf_mat</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots a confusion matrix using Seaborn&#39;s heatmap().</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">),</span>
                    <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Annotate the boxes</span>
                    <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Predicted label&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;True label&quot;</span><span class="p">)</span>
    
<span class="n">plot_conf_mat</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>How about a classification report?</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a classification report using the classification_report function</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>              precision    recall  f1-score   support

           0       0.91      0.86      0.88        35
           1       0.88      0.93      0.90        41

    accuracy                           0.89        76
   macro avg       0.90      0.89      0.89        76
weighted avg       0.90      0.89      0.89        76

</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Challenge:</strong> Write down what each of the columns in this classification report are.</p>
<ul>
<li><strong>Precision</strong> - Indicates the proportion of positive identifications (model predicted class 1) which were actually correct. A model which produces no false positives has a precision of 1.0.</li>
<li><strong>Recall</strong> - Indicates the proportion of actual positives which were correctly classified. A model which produces no false negatives has a recall of 1.0.</li>
<li><strong>F1 score</strong> - A combination of precision and recall. A perfect model achieves an F1 score of 1.0.</li>
<li><strong>Support</strong> - The number of samples each metric was calculated on.</li>
<li><strong>Accuracy</strong> - The accuracy of the model in decimal form. Perfect accuracy is equal to 1.0.</li>
<li><strong>Macro avg</strong> - Short for macro average, the average precision, recall and F1 score between classes. Macro avg doesn’t class imbalance into effort, so if you do have class imbalances, pay attention to this metric.</li>
<li><strong>Weighted avg</strong> - Short for weighted average, the weighted average precision, recall and F1 score between classes. Weighted means each metric is calculated with respect to how many samples there are in each class. This metric will favour the majority class (e.g. will give a high value when one class out performs another due to having more samples).</li>
</ul>
<p>The classification report gives us a range of values for precision, recall and F1 score, time to find these metrics using Scikit-Learn functions.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find the precision score of the model using precision_score()</span>
<span class="n">precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8837209302325582</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find the recall score</span>
<span class="n">recall_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.926829268292683</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find the F1 score</span>
<span class="n">f1_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_preds</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9047619047619047</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Confusion matrix: done.
Classification report: done.
ROC (receiver operator characteristic) curve &amp; AUC (area under curve) score: not done.</p>
<p>Let's fix this.</p>
<p>If you're unfamiliar with what a ROC curve, that's your first challenge, to read up on what one is.</p>
<p>In a sentence, a <a href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic">ROC curve</a> is a plot of the true positive rate versus the false positive rate.</p>
<p>And the AUC score is the area behind the ROC curve.</p>
<p>Scikit-Learn provides a handy function for creating both of these called <code>plot_roc_curve()</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Plot a ROC curve using our current machine learning model using plot_roc_curve</span>
<span class="n">plot_roc_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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9tprvnLlyjrFdsstt/h9993n7u733Xef33rrrVXKzJs3z88880zftWuX//Of//Q+ffr41q1b3d192bJlvm7dOj/22GO9rKys/DV79+71vLw83759e9LjJvvbAAq9mu9VXTUkjcK//3k1xRu/rNd95h7dkrsuOLHWr/voo4+44oorKCsro23btkydOpUOHTrw4YcfMmrUKPbs2cM555zDxIkT+ec//0lJSQnnn38+q1atYvXq1Vx++eXs3LmTvXv3Mnv2bP7t3/6NDz/8kLy8PAYNGsR1111XXn7Pnj3cdtttvPzyy5gZV199Nddff32FeAYMGMD9999fvvzXv/6Vu+66i2+++YbjjjuOqVOncvjhhzN//nxuuukm2rRpQ+/evVm7di3z5s3j7rvvZuPGjZSUlNCmTRueeuopbr/9dl5//XW++eYbrrvuOsaOHcumTZu4+OKL+fLLL9m9ezePPvooJ510EldeeSWFhYWYGVdccQU33ngjY8aM4fzzz2fYsGG8+uqr3HzzzezevZu+ffvy6KOPcuihh9KxY0cuu+wy/vznP7Nr1y5mzZpFt27dKpzbtm3bWLFiBT179ixfN3v2bC644AKOOuoonnnmGX72s5/V+JnNmDGDAQMGcMEFF5SvO/3002v92Vc2Z84cXn/9dQAuu+wyBg4cyK9//esKZYqLiznttNNo0qQJTZo0oWfPnrz00ksMHz6cXr16Jd2vmTFw4EDmzZvH8OHD6xynmoZE6tn48eO59NJLWbFiBaNGjeKGG24AYMKECUyYMIElS5Zw9NFHJ33t5MmTmTBhAkVFRRQWFpKTk8OvfvUrjjvuOIqKiip8oQNMmTKFdevW8c4775Qfr7KXXnqJCy+8EIDNmzdz77338sorr7Bs2TLy8/OZOHEiO3bsYOzYsbz44ov893//N2VlZRX2sXTpUubMmcOMGTN4/PHHadWqFUuWLGHJkiU89thjrFu3jhkzZnDWWWdRVFTE8uXLycvLo6ioiA0bNrBq1SpWrlzJ5ZdfXmG/O3bsYMyYMRQUFLBy5cryBLJPmzZtWLZsGePGjeOBBx6ocm6FhYV07969wrqZM2cyYsQIRowYwcyZM6v7mCpYtWoVffr0qbHctm3byMvLS/ooLi6uUv6TTz6hXbt2ALRr145PP/20SpmePXvy4osv8tVXX7F582YWLlzIxx9/XGMs+fn5/O1vf0vj7GqmGoE0Cvvzyz0qb731Fs8//zwAo0eP5tZbby1f/8ILLwAwcuRIbr755iqvHTBgAL/85S8pLS3loosuomvXrimP9corr3DttdfSpEnwp3zEEUeUbxs1ahTbt29nz549LFu2DIBFixZRXFzMySefDMDOnTsZMGAA7733Hp07dy6/9nzEiBFMmTKlfF9DhgyhefPmQFCjWLFiRXl7+9atW/nHP/5B3759ueKKK9i1axcXXngheXl5dO7cmbVr13L99ddz3nnnMXjw4Arxv//++3Tq1Injjz8eCH41T5o0iZ/85CcAXHTRRQD06dOn/D1NtGnTJtq2bVu+/Mknn7BmzRpOOeUUzIwmTZqwatUqunfvnvRqmtpeYdOiRYt6728ZPHgwS5Ys4aSTTqJt27YMGDCg/PNM5cgjj2Tjxo31EkOkNQIzO9vM3jezNWZ2e5Lth5pZQbh9sZl1jDIekWyozZfNyJEjmTt3Ls2bN+ess87itddeS1ne3avd/9NPP826desYOXIk1113XXn5QYMGUVRURFFREcXFxTz++OMETcjVO+ywwyoc86GHHirfx7p16xg8eDDf//73eeONN2jfvj2jR4/mySef5Dvf+Q7Lly9n4MCBTJo0qUqnbk3HPfTQQwE4+OCD2b17d5XtzZs3r3DNfEFBAVu2bKFTp0507NiRkpISnnnmGQBat25dobP2888/p02bNgCceOKJLF26NGUsUPsawVFHHcWmTZuAIGkdeeSRSfd7xx13UFRUxIIFC3D3Gn8AQFCb2pec6yqyRGBmBwOTgHOAXGCEmeVWKnYlsMXduwD/AfwakQbupJNOKv/yefrppznllFMA6N+/P7NnzwYo317Z2rVr6dy5MzfccANDhgxhxYoVtGjRgm3btiUtP3jwYCZPnlz+Jfn5559X2N60aVPuvfdeFi1axLvvvkv//v158803WbNmDQBfffUVH3zwAd26dWPt2rWUlJQAVLhypbKzzjqLRx99lF27dgHB1Tbbt2/no48+4sgjj+Tqq6/myiuvZNmyZWzevJm9e/fywx/+kF/84hflNZN9unXrRklJSXk8Tz31FKeddlq1x67shBNOKH8tBM1CL730EiUlJZSUlLB06dLy93rgwIEUFBSwc+dOAKZNm1beDzBy5Ej+/ve/85e//KV8Xy+99BIrV66scLx9NYJkj9zcyl9vQU1q+vTpAEyfPp2hQ4dWKbNnzx4+++wzAFasWMGKFSuq1JyS+eCDD6o0i+2vKGsE/YA17r7W3XcCzwCV34WhwPTw+XPAGaY7hKQB+eqrr8jJySl/TJw4kQcffJCpU6fSo0cPnnrqKX7/+98D8Lvf/Y6JEyfSr18/Nm3aRKtWrarsr6CggO7du5OXl8d7773HpZdeSuvWrTn55JPp3r07t9xyS4XyV111FR06dKBHjx707NmTGTNmVNln8+bN+elPf8oDDzxA27ZtmTZtGiNGjKBHjx7079+f9957j+bNm/PII49w9tlnc8opp3DUUUcljW/fMXNzc+nduzfdu3dn7Nix7N69m9dff528vDx69erF7NmzmTBhAhs2bGDgwIHk5eUxZswY7rvvvgr7atasGVOnTuVHP/oR3/ve9zjooIO49tpr037/u3XrxtatW9m2bRslJSWsX7+e/v37l2/v1KkTLVu2ZPHixZx//vmceuqp9OnTh7y8PN58883yjtvmzZszb948HnroIbp27Upubi7Tpk2r9hd8um6//XYWLFhA165dWbBgAbffHjSMFBYWlteOdu3axamnnkpubi7XXHMN//mf/1neNPTggw+Sk5NDaWkpPXr0qFCjWrhwIeedd16d4itX3eVEdX0Aw4A/JiyPBh6uVGYVkJOw/CHQJsm+rgEKgcIOHTokvVyqJnfPXeV3z121X6+VA9OBcPlobWzfvt337t3r7u4zZ870IUOGZDmiirZt2+buwaWJ48aN84kTJ2Y5ovRMnDjRH3vssWyHkVH/8z//4z/4wQ+q3X4gXT6a7Jd95QbBdMrg7lOAKQD5+fmpGxWrcSB1Jko8LV26lPHjx+PufPvb3+aJJ57IdkgVPPbYY0yfPp2dO3fSq1cvxo4dm+2Q0jJu3DhmzZqV7TAyav369fz2t7+tt/1FmQhKgWMSlnOAyl3c+8qUmlkToBXwOSKN0Kmnnsry5cuzHUa1brzxRm688cZsh1FrzZo1Y/To0dkOI6P69u1br/uLso9gCdDVzDqZ2SHAJcDcSmXmApeFz4cBr4VVGJG06L+LSEX78zcRWSJw993AeOBl4F3gWXdfbWb3mNmQsNjjQGszWwPcBFS5xFSkOs2aNeOzzz5TMhAJeTgfQbNmzWr1Omtof0T5+fleWFiY7TDkAKAZykSqqm6GMjNb6u75yV6jO4ulwWratGmtZmESkeQ01pCISMwpEYiIxJwSgYhIzDW4zmIzKwM+2s+XtwE211iqcdE5x4POOR7qcs7HunvbZBsaXCKoCzMrrK7XvLHSOceDzjkeojpnNQ2JiMScEoGISMzFLRFMqblIo6NzjgedczxEcs6x6iMQEZGq4lYjEBGRSpQIRERirlEmAjM728zeN7M1ZlZlRFMzO9TMCsLti82sY+ajrF9pnPNNZlZsZivM7FUzOzYbcdanms45odwwM3Mza/CXGqZzzmY2PPysV5tZ1bkrG5g0/m93MLOFZvZO+P/73GzEWV/M7Akz+9TMVlWz3czswfD9WGFmvet80OqmLmuoD+BggikvOwOHAMuB3Epl/i8wOXx+CVCQ7bgzcM6nA98Kn4+LwzmH5VoAbwCLgPxsx52Bz7kr8A7wnXD5yGzHnYFzngKMC5/nAiXZjruO5/x9oDewqprt5wIvEszw2B9YXNdjNsYaQT9gjbuvdfedwDPA0EplhgLTw+fPAWeYWbJpMxuKGs/Z3Re6+1fh4iKCGeMasnQ+Z4BfAL8BGsNY1emc89XAJHffAuDun2Y4xvqWzjk70DJ83oqqMyE2KO7+BqlnahwKPOmBRcC3zaxdXY7ZGBNBe+DjhOXScF3SMh5MoLMVaJ2R6KKRzjknupLgF0VDVuM5m1kv4Bh3n5fJwCKUzud8PHC8mb1pZovM7OyMRReNdM75buDHZlYKzAeuz0xoWVPbv/caNcb5CJL9sq98jWw6ZRqStM/HzH4M5AOnRRpR9FKes5kdBPwHMCZTAWVAOp9zE4LmoYEEtb6/mVl3d/8i4tiiks45jwCmuftvzWwA8FR4znujDy8r6v37qzHWCEqBYxKWc6haVSwvY2ZNCKqTqapiB7p0zhkzOxO4Axji7t9kKLao1HTOLYDuwOtmVkLQljq3gXcYp/t/e46773L3dcD7BImhoUrnnK8EngVw97eAZgSDszVWaf2910ZjTARLgK5m1snMDiHoDJ5bqcxc4LLw+TDgNQ97YRqoGs85bCb5A0ESaOjtxlDDObv7Vndv4+4d3b0jQb/IEHdvyPOcpvN/+wWCCwMwszYETUVrMxpl/UrnnNcDZwCY2QkEiaAso1Fm1lzg0vDqof7AVnffVJcdNrqmIXffbWbjgZcJrjh4wt1Xm9k9QKG7zwUeJ6g+riGoCVySvYjrLs1zvh84HJgV9ouvd/chWQu6jtI850YlzXN+GRhsZsXAHuAWd/8se1HXTZrn/FPgMTO7kaCJZExD/mFnZjMJmvbahP0edwFNAdx9MkE/yLnAGuAr4PI6H7MBv18iIlIPGmPTkIiI1IISgYhIzCkRiIjEnBKBiEjMKRGIiMScEoEccMxsj5kVJTw6pijbsbpRGmt5zNfDES6Xh8MzfHc/9nGtmV0aPh9jZkcnbPujmeXWc5xLzCwvjdf8xMy+VddjS+OlRCAHoq/dPS/hUZKh445y954EAxLeX9sXu/tkd38yXKJA2bAAAANUSURBVBwDHJ2w7Sp3L66XKP83zkdIL86fAEoEUi0lAmkQwl/+fzOzZeHjpCRlTjSzt8NaxAoz6xqu/3HC+j+Y2cE1HO4NoEv42jPCce5XhuPEHxqu/5X97/wOD4Tr7jazm81sGMF4Tk+Hx2we/pLPN7NxZvabhJjHmNlD+xnnWyQMNmZmj5pZoQXzEPx7uO4GgoS00MwWhusGm9lb4fs4y8wOr+E40sgpEciBqHlCs9CfwnWfAoPcvTdwMfBgktddC/ze3fMIvohLwyEHLgZODtfvAUbVcPwLgJVm1gyYBlzs7t8juBN/nJkdAfwrcKK79wDuTXyxuz8HFBL8cs9z968TNj8HXJSwfDFQsJ9xnk0wpMQ+d7h7PtADOM3Merj7gwTj0Jzu7qeHw078HDgzfC8LgZtqOI40co1uiAlpFL4OvwwTNQUeDtvE9xCMoVPZW8AdZpYDPO/u/zCzM4A+wJJwaI3mBEklmafN7GughGAo4+8C69z9g3D7dOA64GGC+Q3+aGZ/AdIe5trdy8xsbThGzD/CY7wZ7rc2cR5GMORC4uxUw83sGoK/63YEk7SsqPTa/uH6N8PjHELwvkmMKRFIQ3Ej8AnQk6AmW2WiGXefYWaLgfOAl83sKoIhe6e7+8/SOMaoxEHpzCzpHBXh+Df9CAY6uwQYD/ygFudSAAwH3gP+5O5uwbdy2nESzNT1K2AScJGZdQJuBvq6+xYzm0Yw+FplBixw9xG1iFcaOTUNSUPRCtgUjjE/muDXcAVm1hlYGzaHzCVoInkVGGZmR4ZljrD052t+D+hoZl3C5dHAf4Vt6q3cfT5BR2yyK3e2EQyFnczzwIUE4+gXhOtqFae77yJo4ukfNiu1BLYDW83sKOCcamJZBJy875zM7Ftmlqx2JTGiRCANxSPAZWa2iKBZaHuSMhcDq8ysCOhGMJ1fMcEX5l/NbAWwgKDZpEbuvoNgZMdZZrYS2AtMJvhSnRfu778IaiuVTQMm7+ssrrTfLUAxcKy7vx2uq3WcYd/Db4Gb3X05wVzFq4EnCJqb9pkCvGhmC929jOCKppnhcRYRvFcSYxp9VEQk5lQjEBGJOSUCEZGYUyIQEYk5JQIRkZhTIhARiTklAhGRmFMiEBGJuf8PCmr6RxHMkRYAAAAASUVORK5CYII=
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Beautiful! We've gone far beyond accuracy with a plethora extra classification evaluation metrics.</p>
<p>If you're not sure about any of these, don't worry, they can take a while to understand. That could be an optional extension, reading up on a classification metric you're not sure of.</p>
<p>The thing to note here is all of these metrics have been calculated using a single training set and a single test set. Whilst this is okay, a more robust way is to calculate them using <a href="https://scikit-learn.org/stable/modules/cross_validation.html">cross-validation</a>.</p>
<p>We can calculate various evaluation metrics using cross-validation using Scikit-Learn's <code>cross_val_score()</code> function along with the <code>scoring</code> parameter.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import cross_val_score from sklearn&#39;s model_selection module</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># EXAMPLE: By default cross_val_score returns 5 values (cv=5).</span>
<span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> 
                <span class="n">X</span><span class="p">,</span> 
                <span class="n">y</span><span class="p">,</span> 
                <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span>
                <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([0.81967213, 0.90163934, 0.8852459 , 0.88333333, 0.75      ])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># EXAMPLE: Taking the mean of the returned values from cross_val_score </span>
<span class="c1"># gives a cross-validated version of the scoring metric.</span>
<span class="n">cross_val_acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span>
                                        <span class="n">X</span><span class="p">,</span>
                                        <span class="n">y</span><span class="p">,</span>
                                        <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span>
                                        <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>

<span class="n">cross_val_acc</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8479781420765027</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the examples, the cross-validated accuracy is found by taking the mean of the array returned by <code>cross_val_score()</code>.</p>
<p>Now it's time to find the same for precision, recall and F1 score.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find the cross-validated precision</span>
<span class="n">cross_val_precision</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span>
                                              <span class="n">X</span><span class="p">,</span>
                                              <span class="n">y</span><span class="p">,</span>
                                              <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;precision&quot;</span><span class="p">,</span>
                                              <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>

<span class="n">cross_val_precision</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8215873015873015</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find the cross-validated recall</span>
<span class="n">cross_val_recall</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span>
                                           <span class="n">X</span><span class="p">,</span>
                                           <span class="n">y</span><span class="p">,</span>
                                           <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;recall&quot;</span><span class="p">,</span>
                                          <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>

<span class="n">cross_val_recall</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9272727272727274</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find the cross-validated F1 score</span>
<span class="n">cross_val_f1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span>
                                       <span class="n">X</span><span class="p">,</span>
                                       <span class="n">y</span><span class="p">,</span>
                                       <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;f1&quot;</span><span class="p">,</span>
                                       <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>

<span class="n">cross_val_f1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8705403543192143</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Exporting-and-importing-a-trained-model">Exporting and importing a trained model<a class="anchor-link" href="#Exporting-and-importing-a-trained-model"> </a></h3><p>Once you've trained a model, you may want to export it and save it to file so you can share it or use it elsewhere.</p>
<p>One method of exporting and importing models is using the joblib library.</p>
<p>In Scikit-Learn, exporting and importing a trained model is known as <a href="https://scikit-learn.org/stable/modules/model_persistence.html">model persistence</a>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import the dump and load functions from the joblib library</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">dump</span><span class="p">,</span> <span class="n">load</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Use the dump function to export the trained model to file</span>
<span class="n">dump</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="s2">&quot;trained-classifier.joblib&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;trained-classifier.joblib&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Use the load function to import the trained model you just exported</span>
<span class="c1"># Save it to a different variable name to the origial trained model</span>
<span class="n">loaded_clf</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s2">&quot;trained-classifier.joblib&quot;</span><span class="p">)</span>

<span class="c1"># Evaluate the loaded trained model on the test data</span>
<span class="n">loaded_clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8947368421052632</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8947368421052632</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What do you notice about the loaded trained model results versus the original (pre-exported) model results?</p>
<p>Looks the same!</p>
<h2 id="Scikit-Learn-Regression-Practice">Scikit-Learn Regression Practice<a class="anchor-link" href="#Scikit-Learn-Regression-Practice"> </a></h2><p>For the next few exercises, we're going to be working on a regression problem, in other words, using some data to predict a number.</p>
<p>Our dataset is a <a href="https://docs.google.com/spreadsheets/d/1LPEIWJdSSJYrfn-P3UQDIXbEn5gg-o6I7ExLrWTTBWs/edit?usp=sharing">table of car sales</a>, containing different car characteristics as well as a sale price.</p>
<p>We'll use Scikit-Learn's built-in regression machine learning models to try and learn the patterns in the car characteristics and their prices on a certain group of the dataset before trying to predict the sale price of a group of cars the model has never seen before.</p>
<p>To begin, we'll <a href="https://raw.githubusercontent.com/mrdbourke/zero-to-mastery-ml/master/data/car-sales-extended-missing-data.csv">import the data from GitHub</a> into a pandas DataFrame, check out some details about it and try to build a model as soon as possible.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Read in the car sales data</span>
<span class="n">car_sales</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/CongLiu-CN/zero-to-mastery-ml/master/data/car-sales-extended-missing-data.csv&quot;</span><span class="p">)</span>

<span class="c1"># View the first 5 rows of the car sales data</span>
<span class="n">car_sales</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Make</th>
      <th>Colour</th>
      <th>Odometer (KM)</th>
      <th>Doors</th>
      <th>Price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Honda</td>
      <td>White</td>
      <td>35431.0</td>
      <td>4.0</td>
      <td>15323.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>BMW</td>
      <td>Blue</td>
      <td>192714.0</td>
      <td>5.0</td>
      <td>19943.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Honda</td>
      <td>White</td>
      <td>84714.0</td>
      <td>4.0</td>
      <td>28343.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Toyota</td>
      <td>White</td>
      <td>154365.0</td>
      <td>4.0</td>
      <td>13434.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Nissan</td>
      <td>Blue</td>
      <td>181577.0</td>
      <td>3.0</td>
      <td>14043.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get information about the car sales DataFrame</span>
<span class="n">car_sales</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1000 entries, 0 to 999
Data columns (total 5 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   Make           951 non-null    object 
 1   Colour         950 non-null    object 
 2   Odometer (KM)  950 non-null    float64
 3   Doors          950 non-null    float64
 4   Price          950 non-null    float64
dtypes: float64(3), object(2)
memory usage: 39.2+ KB
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looking at the output of <code>info()</code>,</p>
<ul>
<li>How many rows are there total?</li>
<li>What datatypes are in each column?</li>
<li>How many missing values are there in each column?</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find number of missing values in each column</span>
<span class="n">car_sales</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Make             49
Colour           50
Odometer (KM)    50
Doors            50
Price            50
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find the datatypes of each column of car_sales</span>
<span class="n">car_sales</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Make              object
Colour            object
Odometer (KM)    float64
Doors            float64
Price            float64
dtype: object</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Knowing this information, what would happen if we tried to model our data as it is?</p>
<p>Let's see.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># EXAMPLE: This doesn&#39;t work because our car_sales data isn&#39;t all numerical</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="n">car_sales_X</span><span class="p">,</span> <span class="n">car_sales_y</span> <span class="o">=</span> <span class="n">car_sales</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Price&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">car_sales</span><span class="o">.</span><span class="n">Price</span>
<span class="n">rf_regressor</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">car_sales_X</span><span class="p">,</span> <span class="n">car_sales_y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">----------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">ValueError</span>                           Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">&lt;ipython-input-44-476d8071e1b5&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">      2</span> <span class="ansi-green-intense-fg ansi-bold">from</span> sklearn<span class="ansi-yellow-intense-fg ansi-bold">.</span>ensemble <span class="ansi-green-intense-fg ansi-bold">import</span> RandomForestRegressor
<span class="ansi-green-fg">      3</span> car_sales_X<span class="ansi-yellow-intense-fg ansi-bold">,</span> car_sales_y <span class="ansi-yellow-intense-fg ansi-bold">=</span> car_sales<span class="ansi-yellow-intense-fg ansi-bold">.</span>drop<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-blue-intense-fg ansi-bold">&#34;Price&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> axis<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-cyan-intense-fg ansi-bold">1</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> car_sales<span class="ansi-yellow-intense-fg ansi-bold">.</span>Price
<span class="ansi-green-intense-fg ansi-bold">----&gt; 4</span><span class="ansi-yellow-intense-fg ansi-bold"> </span>rf_regressor <span class="ansi-yellow-intense-fg ansi-bold">=</span> RandomForestRegressor<span class="ansi-yellow-intense-fg ansi-bold">(</span><span class="ansi-yellow-intense-fg ansi-bold">)</span><span class="ansi-yellow-intense-fg ansi-bold">.</span>fit<span class="ansi-yellow-intense-fg ansi-bold">(</span>car_sales_X<span class="ansi-yellow-intense-fg ansi-bold">,</span> car_sales_y<span class="ansi-yellow-intense-fg ansi-bold">)</span>

<span class="ansi-green-intense-fg ansi-bold">~\machine_learning\env\lib\site-packages\sklearn\ensemble\_forest.py</span> in <span class="ansi-cyan-fg">fit</span><span class="ansi-blue-intense-fg ansi-bold">(self, X, y, sample_weight)</span>
<span class="ansi-green-fg">    293</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">    294</span>         <span class="ansi-red-intense-fg ansi-bold"># Validate or convert input data</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 295</span><span class="ansi-yellow-intense-fg ansi-bold">         </span>X <span class="ansi-yellow-intense-fg ansi-bold">=</span> check_array<span class="ansi-yellow-intense-fg ansi-bold">(</span>X<span class="ansi-yellow-intense-fg ansi-bold">,</span> accept_sparse<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#34;csc&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> dtype<span class="ansi-yellow-intense-fg ansi-bold">=</span>DTYPE<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    296</span>         y <span class="ansi-yellow-intense-fg ansi-bold">=</span> check_array<span class="ansi-yellow-intense-fg ansi-bold">(</span>y<span class="ansi-yellow-intense-fg ansi-bold">,</span> accept_sparse<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#39;csc&#39;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> ensure_2d<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">False</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> dtype<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    297</span>         <span class="ansi-green-intense-fg ansi-bold">if</span> sample_weight <span class="ansi-green-intense-fg ansi-bold">is</span> <span class="ansi-green-intense-fg ansi-bold">not</span> <span class="ansi-green-intense-fg ansi-bold">None</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>

<span class="ansi-green-intense-fg ansi-bold">~\machine_learning\env\lib\site-packages\sklearn\utils\validation.py</span> in <span class="ansi-cyan-fg">check_array</span><span class="ansi-blue-intense-fg ansi-bold">(array, accept_sparse, accept_large_sparse, dtype, order, copy, force_all_finite, ensure_2d, allow_nd, ensure_min_samples, ensure_min_features, warn_on_dtype, estimator)</span>
<span class="ansi-green-fg">    529</span>                     array <span class="ansi-yellow-intense-fg ansi-bold">=</span> array<span class="ansi-yellow-intense-fg ansi-bold">.</span>astype<span class="ansi-yellow-intense-fg ansi-bold">(</span>dtype<span class="ansi-yellow-intense-fg ansi-bold">,</span> casting<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-blue-intense-fg ansi-bold">&#34;unsafe&#34;</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> copy<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">False</span><span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    530</span>                 <span class="ansi-green-intense-fg ansi-bold">else</span><span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-intense-fg ansi-bold">--&gt; 531</span><span class="ansi-yellow-intense-fg ansi-bold">                     </span>array <span class="ansi-yellow-intense-fg ansi-bold">=</span> np<span class="ansi-yellow-intense-fg ansi-bold">.</span>asarray<span class="ansi-yellow-intense-fg ansi-bold">(</span>array<span class="ansi-yellow-intense-fg ansi-bold">,</span> order<span class="ansi-yellow-intense-fg ansi-bold">=</span>order<span class="ansi-yellow-intense-fg ansi-bold">,</span> dtype<span class="ansi-yellow-intense-fg ansi-bold">=</span>dtype<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">    532</span>             <span class="ansi-green-intense-fg ansi-bold">except</span> ComplexWarning<span class="ansi-yellow-intense-fg ansi-bold">:</span>
<span class="ansi-green-fg">    533</span>                 raise ValueError(&#34;Complex data not supported\n&#34;

<span class="ansi-green-intense-fg ansi-bold">~\machine_learning\env\lib\site-packages\numpy\core\_asarray.py</span> in <span class="ansi-cyan-fg">asarray</span><span class="ansi-blue-intense-fg ansi-bold">(a, dtype, order)</span>
<span class="ansi-green-fg">     83</span> 
<span class="ansi-green-fg">     84</span>     &#34;&#34;&#34;
<span class="ansi-green-intense-fg ansi-bold">---&gt; 85</span><span class="ansi-yellow-intense-fg ansi-bold">     </span><span class="ansi-green-intense-fg ansi-bold">return</span> array<span class="ansi-yellow-intense-fg ansi-bold">(</span>a<span class="ansi-yellow-intense-fg ansi-bold">,</span> dtype<span class="ansi-yellow-intense-fg ansi-bold">,</span> copy<span class="ansi-yellow-intense-fg ansi-bold">=</span><span class="ansi-green-intense-fg ansi-bold">False</span><span class="ansi-yellow-intense-fg ansi-bold">,</span> order<span class="ansi-yellow-intense-fg ansi-bold">=</span>order<span class="ansi-yellow-intense-fg ansi-bold">)</span>
<span class="ansi-green-fg">     86</span> 
<span class="ansi-green-fg">     87</span> 

<span class="ansi-red-intense-fg ansi-bold">ValueError</span>: could not convert string to float: &#39;Honda&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we see, the cell above breaks because our data contains non-numerical values as well as missing data.</p>
<p>To take care of some of the missing data, we'll remove the rows which have no labels (all the rows with missing values in the <code>Price</code> column).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Remove rows with no labels (NaN&#39;s in the Price column)</span>
<span class="n">car_sales</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Price&quot;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Building-a-pipeline">Building a pipeline<a class="anchor-link" href="#Building-a-pipeline"> </a></h3><p>Since our <code>car_sales</code> data has missing numerical values as well as the data isn't all numerical, we'll have to fix these things before we can fit a machine learning model on it.</p>
<p>There are ways we could do this with pandas but since we're practicing Scikit-Learn, we'll see how we might do it with the <code>Pipeline</code> class.</p>
<p>Because we're modifying columns in our dataframe (filling missing values, converting non-numerical data to numbers) we'll need the <code>ColumnTransformer</code>, <code>SimpleImputer</code> and <code>OneHotEncoder</code> classes as well.</p>
<p>Finally, because we'll need to split our data into training and test sets, we'll import <code>train_test_split</code> as well.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import Pipeline from sklearn&#39;s pipeline module</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>

<span class="c1"># Import ColumnTransformer from sklearn&#39;s compose module</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>

<span class="c1"># Import SimpleImputer from sklearn&#39;s impute module</span>
<span class="kn">from</span> <span class="nn">sklearn.impute</span> <span class="kn">import</span> <span class="n">SimpleImputer</span>

<span class="c1"># Import OneHotEncoder from sklearn&#39;s preprocessing module</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span>

<span class="c1"># Import train_test_split from sklearn&#39;s model_selection module</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we've got the necessary tools we need to create our preprocessing <code>Pipeline</code> which fills missing values along with turning all non-numerical data into numbers.</p>
<p>Let's start with the categorical features.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Define different categorical features </span>
<span class="n">categorical_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Make&quot;</span><span class="p">,</span> <span class="s2">&quot;Colour&quot;</span><span class="p">]</span>

<span class="c1"># Create categorical transformer Pipeline</span>
<span class="n">categorical_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="c1"># Set SimpleImputer strategy to &quot;constant&quot; and fill value to &quot;missing&quot;</span>
    <span class="p">(</span><span class="s2">&quot;imputer&quot;</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="s2">&quot;missing&quot;</span><span class="p">)),</span>
    <span class="c1"># Set OneHotEncoder to ignore the unknowns</span>
    <span class="p">(</span><span class="s2">&quot;onehot&quot;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">))])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It would be safe to treat <code>Doors</code> as a categorical feature as well, however since we know the vast majority of cars have 4 doors, we'll impute the missing <code>Doors</code> values as 4.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Define Doors features</span>
<span class="n">door_feature</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Doors&quot;</span><span class="p">]</span>

<span class="c1"># Create Doors transformer Pipeline</span>
<span class="n">door_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="c1"># Set SimpleImputer strategy to &quot;constant&quot; and fill value to 4</span>
    <span class="p">(</span><span class="s2">&quot;imputer&quot;</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;constant&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">4</span><span class="p">))])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now onto the numeric features. In this case, the only numeric feature is the <code>Odometer (KM)</code> column. Let's fill its missing values with the median.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Define numeric features (only the Odometer (KM) column)</span>
<span class="n">numeric_features</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Odometer (KM)&quot;</span><span class="p">]</span>

<span class="c1"># Crearte numeric transformer Pipeline</span>
<span class="n">numeric_transformer</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span>
    <span class="c1"># Set SimpleImputer strategy to fill missing values with the &quot;Median&quot;</span>
    <span class="p">(</span><span class="s2">&quot;imputer&quot;</span><span class="p">,</span> <span class="n">SimpleImputer</span><span class="p">(</span><span class="n">strategy</span><span class="o">=</span><span class="s2">&quot;median&quot;</span><span class="p">))])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Time to put all of our individual transformer <code>Pipeline</code>'s into a single <code>ColumnTransformer</code> instance.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Setup preprocessing steps (fill missing values, then convert to numbers)</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span>
    <span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
        <span class="c1"># Use the categorical_transformer to transform the categorical_features</span>
        <span class="p">(</span><span class="s2">&quot;cat&quot;</span><span class="p">,</span> <span class="n">categorical_transformer</span><span class="p">,</span> <span class="n">categorical_features</span><span class="p">),</span>
        <span class="c1"># Use the door_transformer to transform the door_feature</span>
        <span class="p">(</span><span class="s2">&quot;door&quot;</span><span class="p">,</span> <span class="n">door_transformer</span><span class="p">,</span> <span class="n">door_feature</span><span class="p">),</span>
        <span class="c1"># Use the numeric_transformer to transform the numeric_features</span>
        <span class="p">(</span><span class="s2">&quot;num&quot;</span><span class="p">,</span> <span class="n">numeric_transformer</span><span class="p">,</span> <span class="n">numeric_features</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Boom! Now our <code>preprocessor</code> is ready, time to import some regression models to try out.</p>
<p>Comparing our data to the <a href="https://scikit-learn.org/stable/tutorial/machine_learning_map/index.html">Scikit-Learn machine learning map</a>, we can see there's a handful of different regression models we can try.</p>
<ul>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html">RidgeRegression</a></li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVR.html">SVR(kernel="linear")</a> - short for Support Vector Regressor, a form form of support vector machine.</li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.SVR.html">SVR(kernel="rbf")</a> - short for Support Vector Regressor, a form of support vector machine.</li>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html">RandomForestRegressor</a> - the regression version of RandomForestClassifier.</li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import Ridge from sklearn&#39;s linear_model module</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Ridge</span>

<span class="c1"># Import SVR from sklearn&#39;s svm module</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>

<span class="c1"># Import RandomForestRegressor from sklearn&#39;s ensemble module</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again, thanks to the design of the Scikit-Learn library, we're able to use very similar code for each of these models.</p>
<p>To test them all, we'll create a dictionary of regression models and an empty dictionary for regression model results.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create dictionary of model instances, there should be 4 total key, value pairs</span>
<span class="c1"># in the form {&quot;model_name&quot;: model_instance}.</span>
<span class="c1"># Don&#39;t forget there&#39;s two versions of SVR, one with a &quot;linear&quot; kernel and the</span>
<span class="c1"># other with kernel set to &quot;rbf&quot;.</span>
<span class="n">regression_models</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Ridge&quot;</span><span class="p">:</span> <span class="n">Ridge</span><span class="p">(),</span>
                     <span class="s2">&quot;SVR_linear&quot;</span><span class="p">:</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">),</span>
                     <span class="s2">&quot;SVR_rbf&quot;</span><span class="p">:</span> <span class="n">SVR</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;rbf&quot;</span><span class="p">),</span>
                     <span class="s2">&quot;RandomForestRegressor&quot;</span><span class="p">:</span> <span class="n">RandomForestRegressor</span><span class="p">()}</span>

<span class="c1"># Create an empty dictionary for the regression results</span>
<span class="n">regression_results</span> <span class="o">=</span> <span class="p">{}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our regression model dictionary is prepared as well as an empty dictionary to append results to, time to get the data split into <code>X</code> (feature variables) and <code>y</code> (target variable) as well as training and test sets.</p>
<p>In our car sales problem, we're trying to use the different characteristics of a car (<code>X</code>) to predict its sale price (<code>y</code>).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create car sales X data (every column of car_sales except Price)</span>
<span class="n">car_sales_X</span> <span class="o">=</span> <span class="n">car_sales</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Price&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create car sales y data (the Price column of car_sales)</span>
<span class="n">car_sales_y</span> <span class="o">=</span> <span class="n">car_sales</span><span class="p">[</span><span class="s2">&quot;Price&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Use train_test_split to split the car_sales_X and car_sales_y data into </span>
<span class="c1"># training and test sets.</span>
<span class="c1"># Give the test set 20% of the data using the test_size parameter.</span>
<span class="c1"># For reproducibility set the random_state parameter to 42.</span>
<span class="n">car_X_train</span><span class="p">,</span> <span class="n">car_X_test</span><span class="p">,</span> <span class="n">car_y_train</span><span class="p">,</span> <span class="n">car_y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">car_sales_X</span><span class="p">,</span>
                                                                    <span class="n">car_sales_y</span><span class="p">,</span>
                                                                    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                                                                    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Check the shapes of the training and test datasets</span>
<span class="n">car_X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">car_X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">car_y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">car_y_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((760, 4), (190, 4), (760,), (190,))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>How many rows are in each set?</li>
<li>How many columns are in each set?</li>
</ul>
<p>Alright, our data is split into training and test sets, time to build a small loop which is going to:</p>
<ol>
<li>Go through our <code>regression_models</code> dictionary</li>
<li>Create a <code>Pipeline</code> which contains our <code>preprocessor</code> as well as one of the models in the dictionary</li>
<li>Fits the <code>Pipeline</code> to the car sales training data</li>
<li>Evaluates the target model on the car sales test data and appends the results to our <code>regression_results</code> dictionary</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Loop through the items in the regression_models dictionary</span>
<span class="k">for</span> <span class="n">model_name</span><span class="p">,</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">regression_models</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    
    <span class="c1"># Create a model Pipeline with a preprocessor step and model step</span>
    <span class="n">model_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
                                      <span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">)])</span>
    
    <span class="c1"># Fit the model Pipeline to the car sales training data</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fitting </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">model_pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">car_X_train</span><span class="p">,</span> <span class="n">car_y_train</span><span class="p">)</span>
    
    <span class="c1"># Score the model Pipeline on the test data appending the model_name to the </span>
    <span class="c1"># results dictionary</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Scoring </span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
    <span class="n">regression_results</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">model_pipeline</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">car_X_test</span><span class="p">,</span> 
                                                          <span class="n">car_y_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Fitting Ridge...
Scoring Ridge...
Fitting SVR_linear...
Scoring SVR_linear...
Fitting SVR_rbf...
Scoring SVR_rbf...
Fitting RandomForestRegressor...
Scoring RandomForestRegressor...
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our regression models have been fit, let's see how they did!</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Check the results of each regression model by printing the regression_results</span>
<span class="c1"># dictionary</span>
<span class="n">regression_results</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;Ridge&#39;: 0.254026110579439,
 &#39;SVR_linear&#39;: -0.489452821008145,
 &#39;SVR_rbf&#39;: 0.0018546241516633755,
 &#39;RandomForestRegressor&#39;: 0.2291358152962253}</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Which model did the best?</li>
<li>How could you improve its results?</li>
<li>What metric does the <code>score()</code> method of a regression model return by default?</li>
</ul>
<p>Since we've fitted some models but only compared them via the default metric contained in the <code>score()</code> method (R^2 score or coefficient of determination), let's take the <code>RidgeRegression</code> model and evaluate it with a few other <a href="https://scikit-learn.org/stable/modules/model_evaluation.html#regression-metrics">regression metrics</a>.</p>
<p>Specifically, let's find:</p>
<ol>
<li><strong>R^2 (pronounced r-squared) or coefficient of determination</strong> - Compares your models predictions to the mean of the targets. Values can range from negative infinity (a very poor model) to 1. For example, if all your model does is predict the mean of the targets, its R^2 value would be 0. And if your model perfectly predicts a range of numbers it's R^2 value would be 1. </li>
<li><strong>Mean absolute error (MAE)</strong> - The average of the absolute differences between predictions and actual values. It gives you an idea of how wrong your predictions were.</li>
<li><strong>Mean squared error (MSE)</strong> - The average squared differences between predictions and actual values. Squaring the errors removes negative errors. It also amplifies outliers (samples which have larger errors).</li>
</ol>
<p>Scikit-Learn has a few classes built-in which are going to help us with these, namely, <code>mean_absolute_error</code>, <code>mean_squared_error</code> and <code>r2_score</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import mean_absolute_error from sklearn&#39;s metrics module</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span>

<span class="c1"># Import mean_squared_error from sklearn&#39;s metrics module</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>

<span class="c1"># Import r2_score from sklearn&#39;s metrics module</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>All the evaluation metrics we're concerned with compare a model's predictions with the ground truth labels. Knowing this, we'll have to make some predictions.</p>
<p>Let's create a <code>Pipeline</code> with the <code>preprocessor</code> and a <code>Ridge()</code> model, fit it on the car sales training data and then make predictions on the car sales test data.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create RidgeRegression Pipeline with preprocessor as the &quot;preprocessor&quot; and</span>
<span class="c1"># Ridge() as the &quot;model&quot;.</span>
<span class="n">ridge_pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;preprocessor&quot;</span><span class="p">,</span> <span class="n">preprocessor</span><span class="p">),</span>
                                 <span class="p">(</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">())])</span>

<span class="c1"># Fit the RidgeRegression Pipeline to the car sales training data</span>
<span class="n">ridge_pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">car_X_train</span><span class="p">,</span> <span class="n">car_y_train</span><span class="p">)</span>

<span class="c1"># Make predictions on the car sales test data using the RidgeRegression Pipeline</span>
<span class="n">car_y_preds</span> <span class="o">=</span> <span class="n">ridge_pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">car_X_test</span><span class="p">)</span>

<span class="c1"># View the first 50 predictions</span>
<span class="n">car_y_preds</span><span class="p">[:</span><span class="mi">50</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([18514.480873  , 22204.86580267, 11045.72092225,  6891.87687957,
        8793.93970278, 10926.96786577, 15267.76229871, 13834.80312146,
       20207.44377898, 14412.59968701,  6216.01228306, 16543.06707068,
       11783.69374936, 13492.13284255, 14321.17899086, 16425.45131776,
       15999.88230172,  9925.04252351, 11576.64865889, 11580.55130633,
       10647.22402588, 13113.54464064, 17874.90033257, 23447.29246732,
       11797.33019118, 14481.85336505, 18430.527126  , 14680.33044208,
       20585.63901269, 19953.91395769, 18163.1170151 , 22366.43390174,
       12435.69707467, 14265.25495748, 18351.62656383, 19564.58267503,
       12213.05747919, 12479.20772529, 18677.93478691, 11284.89072638,
       15278.54001605, 17378.81425165, 19247.77623181, 17343.90692672,
       15048.12797569, 12724.44477165, 12389.86021752,  8475.63778401,
       15255.49324105, 18602.79970861])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Nice! Now we've got some predictions, time to evaluate them. We'll find the mean squared error (MSE), mean absolute error (MAE) and R^2 score (coefficient of determination) of our model.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># EXAMPLE: Find the MSE by comparing the car sales test labels to the car sales predictions</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">car_y_test</span><span class="p">,</span> <span class="n">car_y_preds</span><span class="p">)</span>
<span class="c1"># Return the MSE</span>
<span class="n">mse</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>49950182.63337458</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find the MAE by comparing the car sales test labels to the car sales predictions</span>
<span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">car_y_test</span><span class="p">,</span> <span class="n">car_y_preds</span><span class="p">)</span>
<span class="c1"># Return the MAE</span>
<span class="n">mae</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>5713.8215208551555</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Find the R^2 score by comparing the car sales test labels to the car sales predictions</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">car_y_test</span><span class="p">,</span> <span class="n">car_y_preds</span><span class="p">)</span>
<span class="c1"># Return the R^2 score</span>
<span class="n">r2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.254026110579439</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Boom! Our model could potentially do with some hyperparameter tuning (this would be a great extension). And we could probably do with finding some more data on our problem, 1000 rows doesn't seem to be sufficient.</p>
<ul>
<li>How would you export the trained regression model?</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Extensions">Extensions<a class="anchor-link" href="#Extensions"> </a></h2><p>You should be proud. Getting this far means you've worked through a classification problem and regression problem using pure (mostly) Scikit-Learn (no easy feat!).</p>
<p>For more exercises, check out the <a href="https://scikit-learn.org/stable/getting_started.html">Scikit-Learn getting started documentation</a>. A good practice would be to read through it and for the parts you find interesting, add them into the end of this notebook.</p>
<p>Finally, as always, remember, the best way to learn something new is to try it. And try it relentlessly. If you're unsure of how to do something, never be afraid to ask a question or search for something such as, "how to tune the hyperparmaters of a scikit-learn ridge regression model".</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/2020/04/28/Scikit-learn-exercises.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Cong Liu&#39;s blog</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/CongLiu-CN" title="CongLiu-CN"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/tsong_liu" title="tsong_liu"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
